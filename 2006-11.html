<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="ja-JP">
<head><script src="//archive.org/includes/athena.js" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app223.us.archive.org';v.server_ms=355;archive_analytics.send_pageview({});});</script>
<script type="text/javascript" src="https://web-static.archive.org/_static/js/bundle-playback.js?v=1B2M2Y8A" charset="utf-8"></script>
<script type="text/javascript" src="https://web-static.archive.org/_static/js/wombat.js?v=1B2M2Y8A" charset="utf-8"></script>
<script>window.RufflePlayer=window.RufflePlayer||{};window.RufflePlayer.config={"autoplay":"on","unmuteOverlay":"hidden","showSwfDownload":true};</script>
<script type="text/javascript" src="https://web-static.archive.org/_static/js/ruffle/ruffle.js"></script>
<script type="text/javascript">
    __wm.init("https://web.archive.org/web");
  __wm.wombat("http://www.coins.tsukuba.ac.jp:80/~i021216/diary/?","20061107014000","https://web.archive.org/","web","https://web-static.archive.org/_static/",
	      "1162863600");
</script>
<link rel="stylesheet" type="text/css" href="https://web-static.archive.org/_static/css/banner-styles.css?v=1B2M2Y8A" />
<link rel="stylesheet" type="text/css" href="https://web-static.archive.org/_static/css/iconochive.css?v=1B2M2Y8A" />
<!-- End Wayback Rewrite JS Include -->

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="generator" content="tDiary 2.0.0">
	<meta http-equiv="Last-Modified" content="Mon, 06 Nov 2006 18:50:54 GMT">
	<meta http-equiv="Content-Script-Type" content="text/javascript; charset=UTF-8">
	<meta name="author" content="水島宏太">
	<link rev="made" href="mailto:hau51010{at}tree.odn.ne.jp">
	<link rel="index" title="トップ" href="http://www.coins.tsukuba.ac.jp/~i021216/">
	<link rel="start" title="最新" href="./">
	<meta http-equiv="content-style-type" content="text/css">
	<link rel="stylesheet" href="/web/20061107014000cs_/http://www.coins.tsukuba.ac.jp/~i021216/diary/theme/base.css" type="text/css" media="all">
	<link rel="stylesheet" href="/web/20061107014000cs_/http://www.coins.tsukuba.ac.jp/~i021216/diary/theme/another_blue/another_blue.css" title="another_blue" type="text/css" media="all">
	<title>Onion開発日記</title>
	
	<!--link rel="alternate" type="application/x-lirs" title="lirs" href="antenna.lirs"-->
	<link rel="alternate" type="application/rss+xml" title="RSS" href="https://web.archive.org/web/20061107014000/http://www.coins.tsukuba.ac.jp/~i021216/diary/index.rdf">
</head>
<body><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display:none;direction:ltr;" toolbar-mode="auto">
<div id="wm-ipp" style="position:fixed;left:0;top:0;right:0;">
<div id="donato" style="position:relative;width:100%;height:0;">
  <div id="donato-base">
    <iframe id="donato-if" src="https://archive.org/includes/donate.php?as_page=1&amp;platform=wb&amp;referer=https%3A//web.archive.org/web/20061107014000/http%3A//www.coins.tsukuba.ac.jp/~i021216/diary/"
	    scrolling="no" frameborder="0" style="width:100%; height:100%">
    </iframe>
  </div>
</div><div id="wm-ipp-inside">
  <div id="wm-toolbar" style="position:relative;display:flex;flex-flow:row nowrap;justify-content:space-between;">
    <div id="wm-logo" style="/*width:110px;*/padding-top:12px;">
      <a href="/web/" title="Wayback Machine home page"><img src="https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-200.png" srcset="https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-100.png, https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-150.png 1.5x, https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-200.png 2x" alt="Wayback Machine" style="width:100px" border="0" /></a>
    </div>
    <div class="c" style="display:flex;flex-flow:column nowrap;justify-content:space-between;flex:1;">
      <form class="u" style="display:flex;flex-direction:row;flex-wrap:nowrap;" target="_top" method="get" action="/web/submit" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="http://www.coins.tsukuba.ac.jp/~i021216/diary/" onfocus="this.focus();this.select();" style="flex:1;"/><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20061107014000" /><input type="submit" value="Go" />
      </form>
      <div style="display:flex;flex-flow:row nowrap;align-items:flex-end;">
                <div class="s" id="wm-nav-captures" style="flex:1;">
                    <a class="t" href="/web/20061107014000*/http://www.coins.tsukuba.ac.jp/~i021216/diary/" title="See a list of every capture for this URL">77 captures</a>
          <div class="r" title="Timespan for captures of this URL">12 Sep 2004 - 19 May 2024</div>
          </div>
        <div class="k">
          <a href="" id="wm-graph-anchor">
            <div id="wm-ipp-sparkline" title="Explore captures for this URL" style="position: relative">
              <canvas id="wm-sparkline-canvas" width="750" height="27" border="0"></canvas>
            </div>
          </a>
        </div>
      </div>
    </div>
    <div class="n">
      <table>
        <tbody>
          <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
          <tr class="m">
            <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20060902052654/http://www2.coins.tsukuba.ac.jp:80/~i021216/diary/" title="02 Sep 2006"><strong>Sep</strong></a></td>
            <td class="c" id="displayMonthEl" title="You are here: 01:40:00 Nov 07, 2006">NOV</td>
            <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20061207153859/http://www2.coins.tsukuba.ac.jp:80/~i021216/diary/" title="07 Dec 2006"><strong>Dec</strong></a></td>
          </tr>
          <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
          <tr class="d">
            <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20061009082429/http://www2.coins.tsukuba.ac.jp:80/~i021216/diary/" title="08:24:29 Oct 09, 2006"><img src="https://web-static.archive.org/_static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a></td>
            <td class="c" id="displayDayEl" style="width:34px;font-size:22px;white-space:nowrap;" title="You are here: 01:40:00 Nov 07, 2006">07</td>
            <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20061206180726/http://www.coins.tsukuba.ac.jp:80/~i021216/diary/" title="18:07:26 Dec 06, 2006"><img src="https://web-static.archive.org/_static/images/toolbar/wm_tb_nxt_on.png" alt="Next capture" width="14" height="16" border="0" /></a></td>
          </tr>
          <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
          <tr class="y">
            <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20050905082153/http://www2.coins.tsukuba.ac.jp:80/~i021216/diary/" title="05 Sep 2005"><strong>2005</strong></a></td>
            <td class="c" id="displayYearEl" title="You are here: 01:40:00 Nov 07, 2006">2006</td>
            <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20071113172651/http://www2.coins.tsukuba.ac.jp:80/~i021216/diary/" title="13 Nov 2007"><strong>2007</strong></a></td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="r" style="display:flex;flex-flow:column nowrap;align-items:flex-end;justify-content:space-between;">
      <div id="wm-btns" style="text-align:right;height:23px;">
                <span class="xxs">
          <div id="wm-save-snapshot-success">success</div>
          <div id="wm-save-snapshot-fail">fail</div>
          <a id="wm-save-snapshot-open" href="#" title="Share via My Web Archive" >
            <span class="iconochive-web"></span>
          </a>
          <a href="https://archive.org/account/login.php" title="Sign In" id="wm-sign-in">
            <span class="iconochive-person"></span>
          </a>
          <span id="wm-save-snapshot-in-progress" class="iconochive-web"></span>
        </span>
                <a class="xxs" href="http://faq.web.archive.org/" title="Get some help using the Wayback Machine" style="top:-6px;"><span class="iconochive-question" style="color:rgb(87,186,244);font-size:160%;"></span></a>
        <a id="wm-tb-close" href="#close" style="top:-2px;" title="Close the toolbar"><span class="iconochive-remove-circle" style="color:#888888;font-size:240%;"></span></a>
      </div>
      <div id="wm-share" class="xxs">
        <a href="/web/20061107014000/http://web.archive.org/screenshot/http://www.coins.tsukuba.ac.jp/~i021216/diary/"
           id="wm-screenshot"
           title="screenshot">
          <span class="wm-icon-screen-shot"></span>
        </a>
        <a href="#" id="wm-video" title="video">
          <span class="iconochive-movies"></span>
        </a>
        <a id="wm-share-facebook" href="#" data-url="https://web.archive.org/web/20061107014000/http://www.coins.tsukuba.ac.jp:80/~i021216/diary/" title="Share on Facebook" style="margin-right:5px;" target="_blank"><span class="iconochive-facebook" style="color:#3b5998;font-size:160%;"></span></a>
        <a id="wm-share-twitter" href="#" data-url="https://web.archive.org/web/20061107014000/http://www.coins.tsukuba.ac.jp:80/~i021216/diary/" title="Share on Twitter" style="margin-right:5px;" target="_blank"><span class="iconochive-twitter" style="color:#1dcaff;font-size:160%;"></span></a>
      </div>
      <div style="padding-right:2px;text-align:right;white-space:nowrap;">
        <a id="wm-expand" class="wm-btn wm-closed" href="#expand"><span id="wm-expand-icon" class="iconochive-down-solid"></span> <span class="xxs" style="font-size:80%;">About this capture</span></a>
      </div>
    </div>
  </div>
    <div id="wm-capinfo" style="border-top:1px solid #777;display:none; overflow: hidden">
        <div id="wm-capinfo-notice" source="api"></div>
                <div id="wm-capinfo-collected-by">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center">COLLECTED BY</div>
    <div style="padding:3px;position:relative" id="wm-collected-by-content">
            <div style="display:inline-block;vertical-align:top;width:50%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/alexacrawls);"></span>
		Organization: <a style="color:#33f;" href="https://archive.org/details/alexacrawls" target="_new"><span class="wm-title">Alexa Crawls</span></a>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  Starting in 1996, <a href="http://www.alexa.com/">Alexa Internet</a> has been donating their crawl data to the Internet Archive.  Flowing in every day, these data are added to the <a href="http://web.archive.org/">Wayback Machine</a> after an embargo period.
	</div>
	      </div>
      <div style="display:inline-block;vertical-align:top;width:49%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/33_crawl)"></span>
		<div>Collection: <a style="color:#33f;" href="https://archive.org/details/33_crawl" target="_new"><span class="wm-title">33_crawl</span></a></div>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  this data is currently not publicly accessible.
	</div>
	      </div>
    </div>
    </div>
    <div id="wm-capinfo-timestamps">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center" title="Timestamps for the elements of this page">TIMESTAMPS</div>
    <div>
      <div id="wm-capresources" style="margin:0 5px 5px 5px;max-height:250px;overflow-y:scroll !important"></div>
      <div id="wm-capresources-loading" style="text-align:left;margin:0 20px 5px 5px;display:none"><img src="https://web-static.archive.org/_static/images/loading.gif" alt="loading" /></div>
    </div>
    </div>
  </div></div></div></div><div id="wm-ipp-print">The Wayback Machine - https://web.archive.org/web/20061107014000/http://www.coins.tsukuba.ac.jp:80/~i021216/diary/</div>
<script type="text/javascript">//<![CDATA[
__wm.bt(750,27,25,2,"web","http://www.coins.tsukuba.ac.jp/~i021216/diary/","20061107014000",1996,"https://web-static.archive.org/_static/",["https://web-static.archive.org/_static/css/banner-styles.css?v=1B2M2Y8A","https://web-static.archive.org/_static/css/iconochive.css?v=1B2M2Y8A"], false);
  __wm.rw(1);
//]]></script>
<!-- END WAYBACK TOOLBAR INSERT -->
 


<div class="adminmenu">
<span class="adminmenu"><a href="https://web.archive.org/web/20061107014000/http://www.coins.tsukuba.ac.jp/~i021216/">トップ</a></span>
<span class="adminmenu"><a href="update.rb">追記</a></span>
</div>
<h1>Onion開発日記</h1>
<div class="calendar">
<div class="year">2004|<a href="./?date=200409">09</a>|<a href="./?date=200410">10</a>|<a href="./?date=200411">11</a>|<a href="./?date=200412">12</a>|</div>
<div class="year">2005|<a href="./?date=200501">01</a>|<a href="./?date=200502">02</a>|<a href="./?date=200503">03</a>|<a href="./?date=200504">04</a>|<a href="./?date=200505">05</a>|<a href="./?date=200506">06</a>|<a href="./?date=200507">07</a>|<a href="./?date=200508">08</a>|<a href="./?date=200509">09</a>|<a href="./?date=200510">10</a>|<a href="./?date=200511">11</a>|<a href="./?date=200512">12</a>|</div>
<div class="year">2006|<a href="./?date=200601">01</a>|<a href="./?date=200602">02</a>|<a href="./?date=200603">03</a>|<a href="./?date=200604">04</a>|<a href="./?date=200605">05</a>|<a href="./?date=200606">06</a>|<a href="./?date=200607">07</a>|<a href="./?date=200608">08</a>|<a href="./?date=200609">09</a>|<a href="./?date=200610">10</a>|<a href="./?date=200611">11</a>|</div>
</div>
<div class="todo">
	<div class="todo-title">
		<p>ToDo:</p>
	</div>
	<div class="todo-body">
<ul>
</ul>

	</div>
</div>


<hr class="sep">


	
<div class="day">
<h2><span class="date"><a href="./?date=20061107">2006-11-07</a></span> <span class="title"></span></h2>

<div class="body">

<div class="section">
<h3><a href="./?date=20061107#p01"><span class="sanchor">_</span></a> [<a href="./?year=2006;month=4Q;category=Onion">Onion</a>]後置インクリメント/デクリメント演算子の追加</h3><p>
かなり久しぶりに、開発日記らしいエントリ。今日は、実装自体は大して難しくないのだが、単に面倒くさいので後回しにしていた後置インクリメント/デクリメント演算子を追加した。これで、次のサンプルプログラムが動作するようになった。
</p>
<p><strong>Inc.on</strong></p>
<pre>
list = ["A", "B", "C", "D", "E"];
for i = 0; i &lt; list.size; i++ {
  System::out.println(list[i]);
}
</pre>
<p>実行結果</p>
<pre>
&gt;onion Inc.on
A
B
C
D
E
</pre>
<p><strong>Dec.on</strong></p>
<pre>
list = ["A", "B", "C", "D", "E"];
for i = list.size - 1; i &gt;= 0; i-- {
  System::out.println(list[i]);
}
</pre>
<p>実行結果</p>
<pre>
&gt;onion Dec.on
E
D
C
B
A
</pre>
<p>
ただ、リストの要素を最初から順番に取り出すだけならforeach文を使って次のようにかけるので、最初の例はサンプルとしてはあまり意味が無いが。
</p>
<pre>
list = ["A", "B", "C", "D", "E"];
foreach s :String in list {
  System::out.println(s);
}
</pre></div><div class="section">
<h3><a href="./?date=20061107#p02"><span class="sanchor">_</span></a> [<a href="./?year=2006;month=4Q;category=Onion">Onion</a>]今後の方針</h3><p>
後置インクリメント/デクリメント演算子を追加していて感じたのだが、やはり現在のコードのまま、機能拡張を続けるのはやばそうだ。
</p>
<p>
現在のOnionのコンパイラは、大体次のような構成になっているのだが、
</p>
<pre>
入力 --構文解析--&gt; 抽象構文木 --意味解析(型チェックなど)--&gt; 中間言語 --コード生成--&gt; クラスファイル
</pre>
<p>
中間言語の構造をあまりよく考えずに作ったため、中途半端に高級で(式と文の区別やループ構造が存在)、中途半端に低級な(あるメソッド内のローカル変数は全てインデックスで一意に識別されるなど)部分が混在した変な中間言語になってしまった。そのため、抽象構文木から中間言語への変換を行う部分が、不必要に複雑になってしまった。これ以上の機能拡張を行う前に、まずはこの中間言語の構造を見直す必要がありそうだ。
</p></div>

</div>

<div class="comment">

	<div class="caption">[<a href="./?date=20061107#c">ツッコミを入れる</a>]</div>
</div>







		<div class="referer">
		本日のリンク元 | <a href="https://web.archive.org/web/20061107014000/http://prodaza.porkyhost.com/" title="http://prodaza.porkyhost.com/">335</a> | <a href="https://web.archive.org/web/20061107014000/http://www2.xfreehosting.com/hardcore/navsegda/" title="http://www2.xfreehosting.com/hardcore/navsegda/">334</a> | <a href="https://web.archive.org/web/20061107014000/http://vsemoe.sultryserver.com/" title="http://vsemoe.sultryserver.com/">333</a> | <a href="https://web.archive.org/web/20061107014000/http://glazam.sultryserver.com/" title="http://glazam.sultryserver.com/">333</a> | <a href="https://web.archive.org/web/20061107014000/http://www.nastyhost.com/members/sovsem/" title="http://www.nastyhost.com/members/sovsem/">332</a> | <a href="https://web.archive.org/web/20061107014000/http://zakovka.porkyhost.com/" title="http://zakovka.porkyhost.com/">331</a> | <a href="https://web.archive.org/web/20061107014000/http://www.nastyhost.com/members/veselis/" title="http://www.nastyhost.com/members/veselis/">331</a> | <a href="https://web.archive.org/web/20061107014000/http://www2.xfreehosting.com/fetish/zanyato/" title="http://www2.xfreehosting.com/fetish/zanyato/">330</a> | <a href="https://web.archive.org/web/20061107014000/http://www.hostones.com/websites/fetish/zamnoy/" title="http://www.hostones.com/websites/fetish/zamnoy/">252</a> | <a href="https://web.archive.org/web/20061107014000/http://www.google.it/search?hl=it&amp;q=Le+Pocce+di+Samantha+Fox&amp;meta=" title="http://www.google.it/search?hl=it&amp;q=Le Pocce di Sa...">12</a> | <a href="./?date=20061107#t">TrackBack(0)</a>
		</div>
</div>


	<hr class="sep">
	
<div class="day">
<h2><span class="date"><a href="./?date=20061106">2006-11-06</a></span> <span class="title"></span></h2>

<div class="body">

<div class="section">
<h3><a href="./?date=20061106#p01"><span class="sanchor">_</span></a> [<a href="./?year=2006;month=4Q;category=%A5%D7%A5%ED%A5%B0%A5%E9%A5%E0">プログラム</a>][<a href="./?year=2006;month=4Q;category=%B8%C0%B8%EC">言語</a>]情報科学若手の会発表スライド</h3><p>
もう1ヶ月半以上前の話で今更だが、9/16〜9/18に<a href="https://web.archive.org/web/20061107014000/http://wakate.aitea.net/2006.html">第39回情報科学若手の会</a>というのがあったので、参加してきた。
</p>
<p>
内容や感想については今更書いても仕方無いので置いておくが、自分の発表スライドを公開していたのを思い出したので、せっかくなのでリンクを貼っておく。ちなみに内容は、変態言語(braif**kやwhitespaceなど、実用性皆無のネタ言語のこと)についての簡単な紹介と、文字列をbraif**kプログラムに変換する拙作のネタプログラムbbencodeとwhitespaceプログラムに変換するwwencodeの紹介。名前から見てわかる通り、竹迫さんのppencodeにインスパイアされて作ったもの。かなり手抜きコードで、日本語文字列を入力した場合、正しく動作しないとか問題があるが、その辺は容赦していただきたい。
</p>
<ul>
<li><p><a href="https://web.archive.org/web/20061107014000/http://www.coins.tsukuba.ac.jp/~i021216/wakate/2006/mizushima-wakate2006-demo.ppt">発表スライド(.ppt)</a></li>
<li><a href="https://web.archive.org/web/20061107014000/http://www.coins.tsukuba.ac.jp/~i021216/wakate/2006/bbencode.html">bbencodeデモ</a></p>
<p>
<strong>注： Input Textに全角文字を入力しないでください。正しく動作しません。</strong>
</p>
</li>
<li><p><a href="https://web.archive.org/web/20061107014000/http://www.coins.tsukuba.ac.jp/~i021216/wakate/2006/wwencode.html">wwencode デモ</a></p>
<p>
<p>
<strong>注： Input Textに全角文字を入力しないでください。正しく動作しません。</strong>
</p>
</li>
<li>
<a href="https://web.archive.org/web/20061107014000/http://www.coins.tsukuba.ac.jp/~i021216/wakate/2006/matome.ppt">まとめスライド(.ppt)</a>
</ul></div>

</div>

<div class="comment">

	<div class="caption">[<a href="./?date=20061106#c">ツッコミを入れる</a>]</div>
</div>







		<div class="referer">
		本日のリンク元 | <a href="https://web.archive.org/web/20061107014000/http://www.hostones.com/websites/amateurs/zaebun/" title="http://www.hostones.com/websites/amateurs/zaebun/">335</a> | <a href="https://web.archive.org/web/20061107014000/http://www.nastyhost.com/members/sovsem/" title="http://www.nastyhost.com/members/sovsem/">334</a> | <a href="https://web.archive.org/web/20061107014000/http://www.hostones.com/websites/fetish/zamnoy/" title="http://www.hostones.com/websites/fetish/zamnoy/">333</a> | <a href="https://web.archive.org/web/20061107014000/http://www.google.it/search?hl=it&amp;q=www.Moana+Pozzi+sexy.it&amp;btnG=Cerca+con+Google&amp;meta=" title="http://www.google.it/search?hl=it&amp;q=www.Moana Pozz...">12</a> | <a href="https://web.archive.org/web/20061107014000/http://mixi.jp/view_diary.pl?url=http%3A%2F%2Fwww.coins.tsukuba.ac.jp%2F~i021216%2Fdiary%2F%3Fdate%3D20061106%23p01&amp;owner_id=170835" title="http://mixi.jp/view_diary.pl?url=http://www.coins....">12</a> | <a href="https://web.archive.org/web/20061107014000/http://aolsearch.aol.co.uk/web?query=www.adilia.com&amp;restrict=wholeweb&amp;isinit=true&amp;invocationType=uk_wssilver_Cl&amp;avtype=" title="http://aolsearch.aol.co.uk/web?query=www.adilia.co...">10</a> | <a href="https://web.archive.org/web/20061107014000/http://reader.livedoor.com/reader/" title="http://reader.livedoor.com/reader/">8</a> | <a href="https://web.archive.org/web/20061107014000/http://www.google.pl/search?q=ostreporno&amp;hl=pl&amp;hs=t1j&amp;lr=&amp;client=firefox-a&amp;rls=org.mozilla:pl:official_s&amp;start=270&amp;sa=N" title="http://www.google.pl/search?q=ostreporno&amp;hl=pl&amp;hs=...">7</a> | <a href="https://web.archive.org/web/20061107014000/http://www.google.com.ar/search?q=chiquitas+del+cole+fotos+eroticas&amp;hl=es&amp;lr=&amp;start=10&amp;sa=N" title="http://www.google.com.ar/search?q=chiquitas del co...">7</a> | <a href="https://web.archive.org/web/20061107014000/http://www.google.it/search?hl=it&amp;q=WWW.LUOGHI+DA+GUARDONI.+COM&amp;meta=" title="http://www.google.it/search?hl=it&amp;q=WWW.LUOGHI DA ...">6</a> | <a href="./?date=20061106#t">TrackBack(0)</a>
		</div>
</div>


	<hr class="sep">
	
<div class="day">
<h2><span class="date"><a href="./?date=20061103">2006-11-03</a></span> <span class="title"></span></h2>

<div class="body">

<div class="section">
<h3><a href="./?date=20061103#p01"><span class="sanchor">_</span></a> [<a href="./?year=2006;month=4Q;category=Java">Java</a>]<a href="https://web.archive.org/web/20061107014000/http://www.lrr.in.tum.de/~jasmin/">Jasmin - Java Assembler Interpreter</a></h3><p>
<a href="https://web.archive.org/web/20061107014000/http://machine.homeunix.org/weblog/archives/cat_script_on_java.html">こんな毎日・・・ Script_on_Java</a>経由。
</p>
<p>
Jasminというから、てっきり<a href="https://web.archive.org/web/20061107014000/http://jasmin.sourceforge.net/">このJasmin</a>でバイトコードアセンブラを直接実行できるようになったのかと思っていたら、違ったらしいorz。まぎらわしい。「こんな毎日」での紹介を見るに、どうやらX86っぽいアセンブラを実行できるインタプリタにエディタやデバッガなどを統合したものっぽい。
</p></div><div class="section">
<h3><a href="./?date=20061103#p02"><span class="sanchor">_</span></a> [<a href="./?year=2006;month=4Q;category=%B8%C0%B8%EC">言語</a>]<a href="https://web.archive.org/web/20061107014000/http://d.hatena.ne.jp/xtalco/">新言語 Xtalを作る日記</a></h3><p>
新しいスクリプト言語Xtalを作っている人の日記。言語の設計に関する話は、同じく俺言語を作っている身としてなかなか面白い。これからWatchしていくことにしょう。
</p>
<p>
しかし、ちゃんとタイトルの通りに開発日記になっている点は見習わなければいけないな。こっちなんか、タイトルが「Onion開発日記」なのに、Onionの開発について、最近ほとんど書いてないし。一応細々と開発してはいるんだけど、まず現在のバージョンのソースコードが汚過ぎるので、それをまずなんとかしなければという状態orz
</p></div>

</div>

<div class="comment">

		<div class="caption">本日のツッコミ(全2件) [<a href="./?date=20061103#c">ツッコミを入れる</a>]</div>
		<div class="commentshort">
				<p><a href="./?date=20061103#c01"><span class="canchor">_</span></a>
				<span class="commentator">こんな毎日・・・</span>&nbsp;[ああ、Jasmin紛らわしかったですね。すいません。
 （私も最初間違えました、ははは…）]</p>
				<p><a href="./?date=20061103#c02"><span class="canchor">_</span></a>
				<span class="commentator">みずしま</span>&nbsp;[わざわざありがとうございます。「こんな毎日・・・Script_on_Java」はいつもWatchさせてもらっています..]</p>
		</div>
</div>







		<div class="referer">
		本日のリンク元 | <a href="https://web.archive.org/web/20061107014000/http://www2.xfreehosting.com/fetish/zanyato/" title="http://www2.xfreehosting.com/fetish/zanyato/">997</a> | <a href="https://web.archive.org/web/20061107014000/http://www.hostones.com/websites/amateurs/zaebun/" title="http://www.hostones.com/websites/amateurs/zaebun/">845</a> | <a href="https://web.archive.org/web/20061107014000/http://prodaza.porkyhost.com/" title="http://prodaza.porkyhost.com/">734</a> | <a href="https://web.archive.org/web/20061107014000/http://www.nastyhost.com/members/veselis/" title="http://www.nastyhost.com/members/veselis/">675</a> | <a href="https://web.archive.org/web/20061107014000/http://zakovka.porkyhost.com/" title="http://zakovka.porkyhost.com/">671</a> | <a href="https://web.archive.org/web/20061107014000/http://www.nastyhost.com/members/sovsem/" title="http://www.nastyhost.com/members/sovsem/">671</a> | <a href="https://web.archive.org/web/20061107014000/http://www2.xfreehosting.com/hardcore/navsegda/" title="http://www2.xfreehosting.com/hardcore/navsegda/">669</a> | <a href="https://web.archive.org/web/20061107014000/http://vsemoe.sultryserver.com/" title="http://vsemoe.sultryserver.com/">668</a> | <a href="https://web.archive.org/web/20061107014000/http://glazam.sultryserver.com/" title="http://glazam.sultryserver.com/">662</a> | <a href="https://web.archive.org/web/20061107014000/http://www.hostones.com/websites/fetish/zamnoy/" title="http://www.hostones.com/websites/fetish/zamnoy/">502</a> | <a href="./?date=20061103#t">TrackBack(0)</a>
		</div>
</div>


	<hr class="sep">
	
<div class="day">
<h2><span class="date"><a href="./?date=20061031">2006-10-31</a></span> <span class="title"></span></h2>

<div class="body">

<div class="section">
<h3><a href="./?date=20061031#p01"><span class="sanchor">_</span></a> [<a href="./?year=2006;month=4Q;category=Java">Java</a>]<a href="https://web.archive.org/web/20061107014000/http://blog.livedoor.jp/lalha_java/archives/50741760.html">Java Programming Tips - クラスローダーを自作する方法</a></h3><p>
<a href="https://web.archive.org/web/20061107014000/http://cappuccino.jp/keisuken/logbook/">航海日誌</a>経由。
</p>
<p>
クラスローダを自作する方法についての簡単な紹介。クラスローダを自作したい人にとってのとっかかりとして、良いと思う。ただ、はてなブックマークでもつっこまれてたが、これだとURLClassLoaderでいいじゃんとなってしまい、独自クラスローダを作るメリットがイマイチわかりにくいのではという気もする。
</p>
<p>
ちなみに、JVM上で動作してバイトコードにコンパイルできるスクリプト言語処理系(Pnuts/Rhino/Groovy/...)は、ほとんどの場合、独自クラスローダを使ってその仕組みを実現している。Onionでもスクリプトを直接実行するモードでは独自クラスローダを作っており、ソースコードをコンパイルしたバイト列からクラスをロードして実行するようにしている。
</p></div>

</div>

<div class="comment">

		<div class="caption">本日のツッコミ(全2件) [<a href="./?date=20061031#c">ツッコミを入れる</a>]</div>
		<div class="commentshort">
				<p><a href="./?date=20061031#c01"><span class="canchor">_</span></a>
				<span class="commentator">IKeJI</span>&nbsp;[ライブラリインジェクション(DLLインジェクションみたいなの)ができる？]</p>
				<p><a href="./?date=20061031#c02"><span class="canchor">_</span></a>
				<span class="commentator">みずしま</span>&nbsp;[ライブラリインジェクションという言葉が具体的に
 何を指しているかによると思うけど、DLLインジェクション
 みたい..]</p>
		</div>
</div>







		<div class="referer">
		本日のリンク元 | <a href="https://web.archive.org/web/20061107014000/http://www2.xfreehosting.com/fetish/zanyato/" title="http://www2.xfreehosting.com/fetish/zanyato/">2679</a> | <a href="https://web.archive.org/web/20061107014000/http://www.nastyhost.com/members/veselis/" title="http://www.nastyhost.com/members/veselis/">1674</a> | <a href="https://web.archive.org/web/20061107014000/http://www2.xfreehosting.com/hardcore/navsegda/" title="http://www2.xfreehosting.com/hardcore/navsegda/">1670</a> | <a href="https://web.archive.org/web/20061107014000/http://prodaza.porkyhost.com/" title="http://prodaza.porkyhost.com/">1458</a> | <a href="https://web.archive.org/web/20061107014000/http://glazam.sultryserver.com/" title="http://glazam.sultryserver.com/">1357</a> | <a href="https://web.archive.org/web/20061107014000/http://zakovka.porkyhost.com/" title="http://zakovka.porkyhost.com/">1324</a> | <a href="https://web.archive.org/web/20061107014000/http://www.nastyhost.com/members/sovsem/" title="http://www.nastyhost.com/members/sovsem/">1019</a> | <a href="https://web.archive.org/web/20061107014000/http://vsemoe.sultryserver.com/" title="http://vsemoe.sultryserver.com/">1018</a> | <a href="https://web.archive.org/web/20061107014000/http://www.hostones.com/websites/fetish/zamnoy/" title="http://www.hostones.com/websites/fetish/zamnoy/">1005</a> | <a href="https://web.archive.org/web/20061107014000/http://www.hostones.com/websites/amateurs/zaebun/" title="http://www.hostones.com/websites/amateurs/zaebun/">905</a> | <a href="./?date=20061031#t">TrackBack(0)</a>
		</div>
</div>


	<hr class="sep">
	
<div class="day">
<h2><span class="date"><a href="./?date=20061030">2006-10-30</a></span> <span class="title"></span></h2>

<div class="body">

<div class="section">
<h3><a href="./?date=20061030#p01"><span class="sanchor">_</span></a> [<a href="./?year=2006;month=4Q;category=Nemerle">Nemerle</a>]printfマクロ</h3><p>
今日のお題はprintf相当のマクロ。といっても、フルスペックのprintfを実装するのは大変だし、既にNemerleには標準でPrintfマクロがあるので、仕様は最小限のものに留めておく。
</p>
<p>
具体的には、大体次のような仕様にする。
</p>
<ul>
<li>変換指定子は%dのみ</li>
<li>桁数の指定などの機能は一切無し</li>
<li>変換指定子に対して、引数の数が多すぎたり少なすぎたりした場合は、エラーメッセージを表示する</li>
<li>変換指定子に対して、合わない型の引数が渡された場合はエラーメッセージを表示する</li>
</ul>
<p>
仕様としては少ししょぼすぎるが、今回は、マクロ内での型チェックの方法と可変長引数のマクロの処理の方法を学ぶのが目的なので、これでいいのだ。というわけで、以下がソース。Nemerleにまだそんなに慣れていないせいもあって、予想外に行数が増えてしまった。
</p>
<p><strong>printf.n</strong>
<pre>
using System;
using System.Text;
using Nemerle.Collections;
using Nemerle.Macros;
using Nemerle.Compiler;
using C = System.Console;
using P = Nemerle.Compiler.Parsetree;
<br>
macro Printf(format :string, params args : array[expr]){
  def tokenize(f: string) : list[string] {
    def flag() {
      when(f.Length == 1){
        throw ArgumentException("flag name must be specified after '%'");
      }
      match(f[1]){
      | 'd' =&gt; ("%d", f.Substring(2))
      | '%' =&gt; ("%%", f.Substring(2))
      | _   =&gt; throw ArgumentException(
          "illegal flag '" + f.Substring(0, 2) + "'"
        )
      }
    }
    def cont() {
      def x = match(f.IndexOf('%')){
      | -1 =&gt; f.Length
      | n  =&gt; n
      }
      (f.Substring(0, x), f.Substring(x, f.Length - x));
    }
    if(f.Length == 0){
      [];
    }else{
      def (token, rest) = match(f[0]){
      | '%' =&gt; flag()
      | _   =&gt; cont()
      };
      token :: tokenize(rest);
    }
  }
  def parse(tokens :list[string], args :array[P.PExpr]) :list[P.PExpr] {
    mutable x = 0;
    def exprs = List.Map(tokens, fun(t :string){
    | "%d" =&gt; 
      if(x &gt;= args.Length){
        Message.Error("not enough arguments");
        &lt;[ C.Write("%d") ]&gt;
      }else{
        def arg = args[x];
        x++;
        &lt;[ C.Write($arg : int) ]&gt;;
      }
    | "%%" =&gt; &lt;[ C.Write("%") ]&gt;
    | _    =&gt; &lt;[ C.Write($(t :string)) ]&gt;
    });
    when(x &lt; args.Length){
      Message.Error("too many arguments");
    }
    exprs;
  }
  def exprs = parse(tokenize(format), args);
  &lt;[ {.. $exprs} ]&gt;;
}
</pre>
<p>
これを使う側のソースは、次のような感じになる。
</p>
<p><strong>use_printf.n</strong></p>
<pre>
def a = 10;
def b = 20;
Printf("%d + %d = %d\n", a, b, a + b);
</pre>
<p>
コンパイルして実行すると、無事、以下のように表示される。
</p>
<pre>
10 + 20 = 30
</pre>
<p>
また、次のように間違った型の引数を与えると、
</p>
<pre>
def a = 10;
def b = 20;
Printf("%d + %d = %d\n", a, b, "Hello");
</pre>
<p>
ちゃんとエラーメッセージが表示される。
</p>
<pre>
use_printf.n:3:1:3:7: [01;31merror [0m: expected int, got string in type-enforc
ed expression: System.String is not a subtype of System.Int32 [simple require]
</pre></div>

</div>

<div class="comment">

		<div class="caption">本日のツッコミ(全2件) [<a href="./?date=20061030#c">ツッコミを入れる</a>]</div>
		<div class="commentshort">
				<p><a href="./?date=20061030#c01"><span class="canchor">_</span></a>
				<span class="commentator">ると</span>&nbsp;[&gt;use_printf.n:3:1:3:7: error: expected ...
 文字列の中にエスケープシーケ..]</p>
				<p><a href="./?date=20061030#c02"><span class="canchor">_</span></a>
				<span class="commentator">みずしま</span>&nbsp;[すみません。確かにvalidなRDFになっていなかったようなので、修正しておきました。]</p>
		</div>
</div>







		<div class="referer">
		本日のリンク元 | <a href="https://web.archive.org/web/20061107014000/http://www.hostones.com/websites/fetish/zamnoy/" title="http://www.hostones.com/websites/fetish/zamnoy/">435</a> | <a href="https://web.archive.org/web/20061107014000/http://www.hostones.com/websites/amateurs/zaebun/" title="http://www.hostones.com/websites/amateurs/zaebun/">418</a> | <a href="https://web.archive.org/web/20061107014000/http://www.nastyhost.com/members/sovsem/" title="http://www.nastyhost.com/members/sovsem/">341</a> | <a href="https://web.archive.org/web/20061107014000/http://glazam.sultryserver.com/" title="http://glazam.sultryserver.com/">341</a> | <a href="https://web.archive.org/web/20061107014000/http://vsemoe.sultryserver.com/" title="http://vsemoe.sultryserver.com/">340</a> | <a href="https://web.archive.org/web/20061107014000/http://www2.xfreehosting.com/hardcore/navsegda/" title="http://www2.xfreehosting.com/hardcore/navsegda/">335</a> | <a href="https://web.archive.org/web/20061107014000/http://www.nastyhost.com/members/veselis/" title="http://www.nastyhost.com/members/veselis/">335</a> | <a href="https://web.archive.org/web/20061107014000/http://www2.xfreehosting.com/fetish/zanyato/" title="http://www2.xfreehosting.com/fetish/zanyato/">331</a> | <a href="https://web.archive.org/web/20061107014000/http://www.google.it/search?hl=it&amp;q=w.w.w.jessicarizzo.it&amp;meta=lr%3Dlang_it" title="http://www.google.it/search?hl=it&amp;q=w.w.w.jessicar...">22</a> | <a href="https://web.archive.org/web/20061107014000/http://www.google.it/search?hl=it&amp;q=nane+e+nani+porno+gallery&amp;btnG=Cerca&amp;meta=" title="http://www.google.it/search?hl=it&amp;q=nane e nani po...">15</a> | <a href="./?date=20061030#t">TrackBack(0)</a>
		</div>
</div>


	<hr class="sep">
	
<div class="day">
<h2><span class="date"><a href="./?date=20061029">2006-10-29</a></span> <span class="title"></span></h2>

<div class="body">

<div class="section">
<h3><a href="./?date=20061029#p01"><span class="sanchor">_</span></a> [<a href="./?year=2006;month=4Q;category=%A4%BD%A4%CE%C2%BE">その他</a>]体調不良</h3><p>
今日は一日、なんか体調が悪い。やたらに鼻水が出るし、体がだるい。風邪引いたかなあ。
</p></div>

</div>

<div class="comment">

	<div class="caption">[<a href="./?date=20061029#c">ツッコミを入れる</a>]</div>
</div>







		<div class="referer">
		本日のリンク元 | <a href="https://web.archive.org/web/20061107014000/http://www2.xfreehosting.com/fetish/zanyato/" title="http://www2.xfreehosting.com/fetish/zanyato/">677</a> | <a href="https://web.archive.org/web/20061107014000/http://www.hostones.com/websites/amateurs/zaebun/" title="http://www.hostones.com/websites/amateurs/zaebun/">432</a> | <a href="https://web.archive.org/web/20061107014000/http://www.hostones.com/websites/fetish/zamnoy/" title="http://www.hostones.com/websites/fetish/zamnoy/">425</a> | <a href="https://web.archive.org/web/20061107014000/http://prodaza.porkyhost.com/" title="http://prodaza.porkyhost.com/">403</a> | <a href="https://web.archive.org/web/20061107014000/http://glazam.sultryserver.com/" title="http://glazam.sultryserver.com/">344</a> | <a href="https://web.archive.org/web/20061107014000/http://vsemoe.sultryserver.com/" title="http://vsemoe.sultryserver.com/">343</a> | <a href="https://web.archive.org/web/20061107014000/http://www2.xfreehosting.com/hardcore/navsegda/" title="http://www2.xfreehosting.com/hardcore/navsegda/">341</a> | <a href="https://web.archive.org/web/20061107014000/http://www.nastyhost.com/members/veselis/" title="http://www.nastyhost.com/members/veselis/">340</a> | <a href="https://web.archive.org/web/20061107014000/http://www.nastyhost.com/members/sovsem/" title="http://www.nastyhost.com/members/sovsem/">334</a> | <a href="https://web.archive.org/web/20061107014000/http://zakovka.porkyhost.com/" title="http://zakovka.porkyhost.com/">332</a> | <a href="./?date=20061029#t">TrackBack(0)</a>
		</div>
</div>


	<hr class="sep">
	
<div class="day">
<h2><span class="date"><a href="./?date=20061028">2006-10-28</a></span> <span class="title"></span></h2>

<div class="body">

<div class="section">
<h3><a href="./?date=20061028#p01"><span class="sanchor">_</span></a> [<a href="./?year=2006;month=4Q;category=Java">Java</a>]JavaでGenericなVisitor</h3><p>
絶対誰かが既にやってそうだけど、あえてやってみる。
</p>
<p>
JavaでVisitorパターンを使う場合の欠点として、
</p>
<ul>
<li>visitメソッドに渡すコンテキスト情報を表す引数の型を、Visitorクラスを作るときに決定しなければならないため、個々のVisitorのサブクラスごとに異なる型の情報を渡すのが面倒</li>
<li>visitメソッドの返り値の型をVisitorクラスを作るときに決定しなければならないため、個々のVisitorのサブクラスごとに異なる型の値を返したり、個々のサブクラスでvisitメソッドごとに異なる型の値を返したりできない</li>
</ul>
<p>
というのがあったのだが、Java 5にはせっかくGenericsがあるんだから、この辺をもっとうまく書けるんじゃなかろうかということで、作ってみた。要点は、次の３つ。
</p>
<ul>
<li>Visitorインタフェースをvisitメソッドに渡すコンテキスト情報の型でパラメータ化する</li>
<li>個々のvisitメソッドは、Visitorインタフェースで宣言する段階では、
返り値の型をパラメータ化した多相メソッドとして宣言しておく。
</li>
<li>visit対象のオブジェクトのクラスでは、acceptを返り値の型とコンテキスト情報の型でパラメータ化した多相メソッドとして宣言しておく。
</li>
</ul>
<p>
実際に作ってみたソースは以下。Visitorインタフェースでは、visitメソッドの返り値の具体的な型もコンテキスト情報の型も指定せず、実際に処理を行うVisitorの実装クラスCalculatorで個々のvisitメソッドの型とコンテキスト情報の型を指定できている。
</p>
<p>
しかし、この方法には欠点がある。acceptメソッドが返す値の型はVisitorの実装クラスのvisitメソッドの型に依存しているため、acceptの呼び出し結果の値を入れる変数の型を間違えると、実行時エラーになってしまうのだ。つまり、この方法を使って作ったVisitorは型安全では無くなってしまう。
</p>
<p>
ただ、コンパイラはvisitメソッドの実装箇所で、型安全じゃないという旨の警告メッセージを出してくれるので、acceptを呼び出す部分で注意さえしていれば、わりと使えるテクニックなのではないかと思う。
</p>
<pre>
import java.util.*;
<br>
public class Main {
  public static void main(String[] args){
    Exp exp = new BlkExp(
      new SetExp("x", new IntExp(2)),
      new SetExp("y", new IntExp(3)),
      new SetExp("z", new IntExp(4)),
      new MulExp(new AddExp(new VarExp("x"), new VarExp("y")), new VarExp("z"))
    );
    Integer result = exp.accept(new Calculator(), new Env());
    //String s = exp.accept(new Calculator(), new Env()); と書くと実行時にClassCastException発生
    System.out.printf("{ x = 2; y = 3; z = 4; (x + y) * z } = %d%n", result);
  }
}
<br>
interface Visitor&lt;C&gt; {
  &lt;R&gt; R visit(AddExp e, C c);
  &lt;R&gt; R visit(SubExp e, C c);
  &lt;R&gt; R visit(MulExp e, C c);
  &lt;R&gt; R visit(DivExp e, C c);
  &lt;R&gt; R visit(IntExp e, C c);
  &lt;R&gt; R visit(VarExp e, C c);
  &lt;R&gt; R visit(SetExp e, C c);
  &lt;R&gt; R visit(BlkExp e, C C);
}
<br>
class Calculator implements Visitor&lt;Env&gt; {
  public Integer visit(AddExp e, Env env){
    Integer lval = e.left.accept(this, env);
    Integer rval = e.right.accept(this, env);
    return lval + rval;
  }
  public Integer visit(SubExp e, Env env){
    Integer lval = e.left.accept(this, env);
    Integer rval = e.right.accept(this, env);
    return lval - rval;
  }
  public Integer visit(MulExp e, Env env){
    Integer lval = e.left.accept(this, env);
    Integer rval = e.right.accept(this, env);
    return lval * rval;
  }
  public Integer visit(DivExp e, Env env){
    Integer lval = e.left.accept(this, env);
    Integer rval = e.right.accept(this, env);
    return lval / rval;
  }
  public Integer visit(IntExp e, Env env){
    return e.value;
  }
  public Integer visit(VarExp e, Env env){
    Integer value = env.lookup(e.name);
    if(value == null) throw new RuntimeException("undefined variable '" + e.name + "'");
    return value;
  }
  public Integer visit(SetExp e, Env env){
    Integer value = e.exp.accept(this, env);
    env.set(e.name, value);
    return value;
  }
  public Integer visit(BlkExp e, Env env){
    Integer value = 0;
    for(Exp element : e.exps) value = element.accept(this, env);
    return value;
  }
}
<br>
class Env {
  private Map&lt;String, Integer&gt; table = new HashMap&lt;String, Integer&gt;();
  Integer lookup(String name){ 
    return table.get(name); 
  }
  void set(String name, Integer value) {
    table.put(name, value);
  }
}
<br>
abstract class Exp {
  abstract &lt;R, C&gt; R accept(Visitor&lt;C&gt; v, C c);
}
<br>
abstract class BinExp extends Exp {
  final Exp left, right;
  BinExp(Exp left, Exp right) {
    this.left  = left;
    this.right = right;
  }
}
<br>
class AddExp extends BinExp {
  AddExp(Exp left, Exp right){ super(left, right); }
  &lt;R, C&gt; R accept(Visitor&lt;C&gt; v, C c){ return v.&lt;R&gt;visit(this, c); }
}
<br>
class SubExp extends BinExp {
  SubExp(Exp left, Exp right){ super(left, right); }
  &lt;R, C&gt; R accept(Visitor&lt;C&gt; v, C c){ return v.&lt;R&gt;visit(this, c); }
}
<br>
class MulExp extends BinExp {
  MulExp(Exp left, Exp right){ super(left, right); }
  &lt;R, C&gt; R accept(Visitor&lt;C&gt; v, C c){ return v.&lt;R&gt;visit(this, c); }
}
<br>
class DivExp extends BinExp {
  DivExp(Exp left, Exp right){ super(left, right); }
  &lt;R, C&gt; R accept(Visitor&lt;C&gt; v, C c){ return v.&lt;R&gt;visit(this, c); }
}
<br>
class IntExp extends Exp {
  final int value;
  IntExp(int value){ this.value = value; }
  &lt;R, C&gt; R accept(Visitor&lt;C&gt; v, C c){ return v.&lt;R&gt;visit(this, c); }
}
<br>
class VarExp extends Exp {
  final String name;
  VarExp(String name){ this.name = name; }
  &lt;R, C&gt; R accept(Visitor&lt;C&gt; v, C c){ return v.&lt;R&gt;visit(this, c); }
}
<br>
class SetExp extends Exp {
  final String name;
  final Exp exp;
  SetExp(String name, Exp exp){ this.name = name; this.exp = exp; }
  &lt;R, C&gt; R accept(Visitor&lt;C&gt; v, C c){ return v.&lt;R&gt;visit(this, c); }
}
<br>
class BlkExp extends Exp {
  final List&lt;? extends Exp&gt; exps;
  BlkExp(Exp... exps){
    this.exps = Arrays.asList(exps);
  }
  &lt;R, C&gt; R accept(Visitor&lt;C&gt; v, C c){ return v.&lt;R&gt;visit(this, c); }
}
</pre></div><div class="section">
<h3><a href="./?date=20061028#p02"><span class="sanchor">_</span></a> [<a href="./?year=2006;month=4Q;category=Java">Java</a>]キャスト推論</h3><p>
引き続き、Genericsネタ。ただし、今度のは全く役に立たないが。
</p>
<p>
Javaの多相メソッドでは、メソッド呼び出しを書く際に、型引数について、メソッド呼び出しの引数や返り値を代入する変数の型からある程度推論してくれる。このことを利用すると、例えば<a href="https://web.archive.org/web/20061107014000/http://www.coins.tsukuba.ac.jp/~i021216/diary/?date=20051003#p02">2005-10-03の日記</a>のような型安全なリストリテラルを簡単に作るメソッドを作ることができる。
</p>
<p>
今回のネタは、この推論機構を悪用して、どの型にキャストするのかを書かずにキャストを行うことができるメソッドを定義するというもの。
</p>
<p>
まず、キャストを行うメソッドの定義は、次のようになる。
<pre>
public class Util {
  private static &lt;P, R&gt; R cast(P param){
    return (R)param;
  }
}
</pre>
<p>
メソッドの定義は実にシンプルで、２つの型をP, Rを型引数に取り、P型の値をただ単にR型にキャストする多相メソッドcastを定義しているだけ。
</p>
<p>
一方、これを使う側のコードは次のようになる。
</p>
<pre>
public class Main {
  public static void main(String[] args){
    Object o = "Hello, World";//Object型に文字列を入れておく
    String s = Util.cast(o);//Util.&lt;Object, String&gt;cast(o);と推論される
    System.out.println(s);
  }
}
</pre>
<p>
このようにキャストする型名を書かずにキャストできるわけだが、Genericsを使う前提ならキャストはほとんど書かないし、castメソッドの呼び出し結果を変数に代入しないとちゃんと推論してくれないため、実用性はほとんど無い。
</p></div>

</div>

<div class="comment">

	<div class="caption">[<a href="./?date=20061028#c">ツッコミを入れる</a>]</div>
</div>







		<div class="referer">
		本日のリンク元 | <a href="https://web.archive.org/web/20061107014000/http://www.hostones.com/websites/fetish/zamnoy/" title="http://www.hostones.com/websites/fetish/zamnoy/">428</a> | <a href="https://web.archive.org/web/20061107014000/http://zakovka.porkyhost.com/" title="http://zakovka.porkyhost.com/">347</a> | <a href="https://web.archive.org/web/20061107014000/http://vsemoe.sultryserver.com/" title="http://vsemoe.sultryserver.com/">347</a> | <a href="https://web.archive.org/web/20061107014000/http://prodaza.porkyhost.com/" title="http://prodaza.porkyhost.com/">347</a> | <a href="https://web.archive.org/web/20061107014000/http://www2.xfreehosting.com/hardcore/navsegda/" title="http://www2.xfreehosting.com/hardcore/navsegda/">346</a> | <a href="https://web.archive.org/web/20061107014000/http://www.hostones.com/websites/amateurs/zaebun/" title="http://www.hostones.com/websites/amateurs/zaebun/">346</a> | <a href="https://web.archive.org/web/20061107014000/http://www.nastyhost.com/members/sovsem/" title="http://www.nastyhost.com/members/sovsem/">345</a> | <a href="https://web.archive.org/web/20061107014000/http://glazam.sultryserver.com/" title="http://glazam.sultryserver.com/">344</a> | <a href="https://web.archive.org/web/20061107014000/http://www.nastyhost.com/members/veselis/" title="http://www.nastyhost.com/members/veselis/">341</a> | <a href="https://web.archive.org/web/20061107014000/http://www2.xfreehosting.com/fetish/zanyato/" title="http://www2.xfreehosting.com/fetish/zanyato/">339</a> | <a href="./?date=20061028#t">TrackBack(0)</a>
		</div>
</div>


	<hr class="sep">
	
<div class="day">
<h2><span class="date"><a href="./?date=20061027">2006-10-27</a></span> <span class="title"></span></h2>

<div class="body">

<div class="section">
<h3><a href="./?date=20061027#p01"><span class="sanchor">_</span></a> [<a href="./?year=2006;month=4Q;category=%B8%A6%B5%E6">研究</a>]ベンチマーク</h3><p>
4年生以降になってたぶん初めて、自分の研究のためにベンチマークを取った。しかし、Javaでベンチマークを取るのは難しい。うまくやらないと、動作途中にJITコンパイラの最適化が始まったりして、入力の長さと性能の関係がわかりにくくなる。特に今回は、入力が比較的短い場合について測定したので、なおさらだ。結局、-Xintオプションでインタプリタモードにしてベンチマークを取ってしまったorz
</p></div><div class="section">
<h3><a href="./?date=20061027#p02"><span class="sanchor">_</span></a> [<a href="./?year=2006;month=4Q;category=Nemerle">Nemerle</a>]言語紹介</h3><p>
友人が企画した(今のところ)学内のみのイベント<a href="https://web.archive.org/web/20061107014000/http://www.mirai-kaigi.com/kaigi/001/#extended"><strong>未来会議</strong></a>で、Nemerleについて紹介する発表をしてきた。
</p>
<p>
自分で言うのもなんだが、誰を対象にした発表なんだかよくわからないものになってしまった。関数型言語とかマクロについてあまり知らない人を対象にするなら、基本的な部分についてもっとちゃんと説明すべきだったし、知っている人を対象にするならその辺は、はしょってしまうべきだった。結局、どっちつかずになってしまった。
</p></div>

</div>

<div class="comment">

		<div class="caption">本日のツッコミ(全1件) [<a href="./?date=20061027#c">ツッコミを入れる</a>]</div>
		<div class="commentshort">
				<p><a href="./?date=20061027#c01"><span class="canchor">_</span></a>
				<span class="commentator">らふにん</span>&nbsp;[そういう人たちが混在する場でしたからねぇ。
 といっても、そこら辺がわからない方が少数派だったと思いますが。]</p>
		</div>
</div>







		<div class="referer">
		本日のリンク元 | <a href="https://web.archive.org/web/20061107014000/http://www.google.com/search?hl=en&amp;q=CHICA+PUTA++MASTURBANDOS&amp;btnG=Google+Search" title="google検索(CHICA PUTA  MASTURBANDOS)">26</a> | <a href="https://web.archive.org/web/20061107014000/http://aolsearch.aol.co.uk/web?query=www.adilia.com&amp;restrict=wholeweb&amp;isinit=true&amp;invocationType=uk_wssilver_Cl&amp;avtype=" title="http://aolsearch.aol.co.uk/web?query=www.adilia.co...">15</a> | <a href="https://web.archive.org/web/20061107014000/http://www.google.com/ig" title="http://www.google.com/ig">4</a> | <a href="https://web.archive.org/web/20061107014000/http://www.google.co.ma/search?hl=fr&amp;q=www.sexy+selen.com&amp;btnG=Recherche+Google&amp;meta=" title="http://www.google.co.ma/search?hl=fr&amp;q=www.sexy se...">4</a> | <a href="https://web.archive.org/web/20061107014000/http://www.pop.com.br/barra.php?url=http://www2.coins.tsukuba.ac.jp/~i021216/diary/?date=20061027" title="http://www.pop.com.br/barra.php?url=http://www2.co...">3</a> | <a href="https://web.archive.org/web/20061107014000/http://www.google.it/search?q=madri+fottute+pictures&amp;hl=it&amp;lr=&amp;start=10&amp;sa=N" title="http://www.google.it/search?q=madri fottute pictur...">3</a> | <a href="https://web.archive.org/web/20061107014000/http://www.google.com/search?hl=en&amp;q=culeadas%20culiadas%20caseras" title="google検索(culeadas culiadas caseras)">3</a> | <a href="https://web.archive.org/web/20061107014000/http://www.google.ae/search?q=meda+cafe+sexsy&amp;hl=ar&amp;lr=&amp;start=90&amp;sa=N" title="http://www.google.ae/search?q=meda cafe sexsy&amp;hl=a...">3</a> | <a href="https://web.archive.org/web/20061107014000/http://www.google.it/search?q=www.video+porno+gratis.it&amp;hl=it&amp;lr=&amp;start=10&amp;sa=N" title="http://www.google.it/search?q=www.video porno grat...">2</a> | <a href="https://web.archive.org/web/20061107014000/http://www.google.it/search?hl=it&amp;q=www.filmhard.it&amp;btnG=Cerca+con+Google&amp;meta=lr%3Dlang_it" title="http://www.google.it/search?hl=it&amp;q=www.filmhard.i...">2</a> | <a href="./?date=20061027#t">TrackBack(0)</a>
		</div>
</div>


	<hr class="sep">
	
<div class="day">
<h2><span class="date"><a href="./?date=20061021">2006-10-21</a></span> <span class="title"></span></h2>

<div class="body">

<div class="section">
<h3><a href="./?date=20061021#p01"><span class="sanchor">_</span></a> [<a href="./?year=2006;month=4Q;category=Java">Java</a>][<a href="./?year=2006;month=4Q;category=Ruby">Ruby</a>]Ruby流のブロックをJavaで実現するときの問題点</h3><p>
<a href="https://web.archive.org/web/20061107014000/http://cappuccino.jp/keisuken/logbook/20061021.html#c">航海日誌</a>より引用：
</p>
<blockquote>
Ruby流のブロックをパターンで
というのは何故議論されないのかな．
一応クロージャを導入しなくとも，anonymous classでできますよ(ほんのちょっと冗長だけど)．前に書いたソースを再掲すると，
</blockquote>
<p>
現在のJavaでもanonymous classでRubyのブロック相当のものを実現できるというのは賛成で特に異論は無いんですが、現在のJavaの言語仕様の範囲ではchecked exceptionに対して透過的なブロックを作るのが難しいという問題点があるんじゃないでしょうか。
</p>
<p>
例えば、keisukenさんのInputStreamBlockだと、run()の中からIOException以外のExceptionを投げることができません。runのthrows節にExceptionを追加するか、RuntimeExceptionにラップしてthrowするという解決策は考えられますが、それだと今度はchecked exceptionの利点を殺してしまうことになりかねません。あるいは、おっしゃられるように型パラメータを使って、
</p>
<pre>
import java.io.*;
public class Test {
  static abstract class InputStreamBlock&lt;E extends Exception&gt; {
    InputStream in;
    public InputStreamBlock(InputStream in) throws IOException, E {
      this.in = in;
      try {
        run();
      } finally {
        in.close();
      }
    }
    abstract void run() throws IOException, E;
  }
  ...
}
</pre>
<p>
のようにすることで、IOException以外の種類の例外を投げられるようになりますが、これではthrowsできるcheced exceptionが1種類に限定されてしまいます。実用上は1種類だけでもなんとかなるケースが多いとは思いますが、リフレクション系APIなど、いくつもの種類の例外を投げるメソッドを使った場合に困ることもあるのではないかと思います。
</p>
<p>
ちなみに、Neal Gafterのブログのエントリ<a href="https://web.archive.org/web/20061107014000/http://gafter.blogspot.com/2006/09/nominal-closures-for-java-version-02.html">Nominal Closures for Java (version 0.2)</a>中の
「5. Exception type parameters」で、その問題に
対する解決策が議論されています。
</p></div>

</div>

<div class="comment">

		<div class="caption">本日のツッコミ(全3件) [<a href="./?date=20061021#c">ツッコミを入れる</a>]</div>
		<div class="commentshort">
				<p><a href="./?date=20061021#c01"><span class="canchor">_</span></a>
				<span class="commentator">keisuken</span>&nbsp;[「Ruby流のブロックをJavaで実現するときの問題点の例外の件」についてなんですが，実はGenericsだけではだ..]</p>
				<p><a href="./?date=20061021#c02"><span class="canchor">_</span></a>
				<span class="commentator">みずしま</span>&nbsp;[たぶんわかっておられると思うのですが、念のため補足しておくと、Nominal Closures for Javaの話..]</p>
				<p><a href="./?date=20061021#c03"><span class="canchor">_</span></a>
				<span class="commentator">keisuken</span>&nbsp;[みずしまさん:
 &gt; Nominal Closures for Javaの話は、Dolphinでそういうのを入れる事..]</p>
		</div>
</div>







		<div class="referer">
		本日のリンク元 | <a href="https://web.archive.org/web/20061107014000/http://www2.xfreehosting.com/fetish/zanyato/" title="http://www2.xfreehosting.com/fetish/zanyato/">3121</a> | <a href="https://web.archive.org/web/20061107014000/http://prodaza.porkyhost.com/" title="http://prodaza.porkyhost.com/">2318</a> | <a href="https://web.archive.org/web/20061107014000/http://vsemoe.sultryserver.com/" title="http://vsemoe.sultryserver.com/">2216</a> | <a href="https://web.archive.org/web/20061107014000/http://www.nastyhost.com/members/sovsem/" title="http://www.nastyhost.com/members/sovsem/">2192</a> | <a href="https://web.archive.org/web/20061107014000/http://www.nastyhost.com/members/veselis/" title="http://www.nastyhost.com/members/veselis/">2186</a> | <a href="https://web.archive.org/web/20061107014000/http://zakovka.porkyhost.com/" title="http://zakovka.porkyhost.com/">2131</a> | <a href="https://web.archive.org/web/20061107014000/http://www2.xfreehosting.com/hardcore/navsegda/" title="http://www2.xfreehosting.com/hardcore/navsegda/">2089</a> | <a href="https://web.archive.org/web/20061107014000/http://www.hostones.com/websites/amateurs/zaebun/" title="http://www.hostones.com/websites/amateurs/zaebun/">1900</a> | <a href="https://web.archive.org/web/20061107014000/http://www.hostones.com/websites/fetish/zamnoy/" title="http://www.hostones.com/websites/fetish/zamnoy/">1886</a> | <a href="https://web.archive.org/web/20061107014000/http://glazam.sultryserver.com/" title="http://glazam.sultryserver.com/">1739</a> | <a href="./?date=20061021#t">TrackBack(0)</a>
		</div>
</div>


	<hr class="sep">
	
<div class="day">
<h2><span class="date"><a href="./?date=20061019">2006-10-19</a></span> <span class="title"></span></h2>

<div class="body">

<div class="section">
<h3><a href="./?date=20061019#p01"><span class="sanchor">_</span></a> [<a href="./?year=2006;month=4Q;category=%BC%F8%B6%C8">授業</a>]システム情報工学セミナー</h3><p>
シス情セミナーの教室変更があったのをすっかり忘れていたおかげで、授業に出席し損なってしまった。おかげで来週までに欠席レポート書くはめにorz
</p></div><div class="section">
<h3><a href="./?date=20061019#p02"><span class="sanchor">_</span></a> [<a href="./?year=2006;month=4Q;category=Java">Java</a>]ObjectInputStreamでカスタムクラスローダを使う</h3><p>
ObjectInputStream#readObject()はデフォルトでは、system classloaderを使ってクラスをロードしているようなのだが、自前のクラスローダなどを使ってクラスを読み込めないと困る事態が起きてしまった。
</p>
<p>
なんとかObjectInputStream#readObject()のときに、カスタムクラスローダを使えないか調べていたところ、ObjectInputStreamをサブクラス化して、
</p>
<pre>
Class&lt;?&gt; ObjectInputStream#resolveClass(ObjectStreamClass)
</pre>
<p>
をオーバーライドしてやれば良いらしい。参考： <a href="https://web.archive.org/web/20061107014000/http://forum.java.sun.com/thread.jspa?threadID=468339&amp;messageID=2159594">
Can't use custom ClassLoader with ObjectInputStream
</a>
<p>
で、こんな感じでカレントスレッドのコンテキストクラスローダを使うようにすることで、ObjectInputStream#readObject()をうまく動作させることができた。
</p>
<pre>
package jp.gr.java_conf.mizu.javaflow.servlet;
<br>
import java.io.IOException;
import java.io.InputStream;
import java.io.ObjectInputStream;
import java.io.ObjectStreamClass;
<br>
public class CustomObjectInputStream extends ObjectInputStream {
  public CustomObjectInputStream(InputStream in) throws IOException {
    super(in);
  }
<br>
  @Override
  protected Class&lt;?&gt; resolveClass(ObjectStreamClass desc) throws IOException, ClassNotFoundException {
    try {
      return Class.forName(desc.getName(), true, Thread.currentThread().getContextClassLoader());
    }catch(ClassNotFoundException e){
      return super.resolveClass(desc);
    }
  }  
}
</pre></div>

</div>

<div class="comment">

	<div class="caption">[<a href="./?date=20061019#c">ツッコミを入れる</a>]</div>
</div>







		<div class="referer">
		本日のリンク元 | <a href="https://web.archive.org/web/20061107014000/http://www.nastyhost.com/members/veselis/" title="http://www.nastyhost.com/members/veselis/">1402</a> | <a href="https://web.archive.org/web/20061107014000/http://www2.xfreehosting.com/fetish/zanyato/" title="http://www2.xfreehosting.com/fetish/zanyato/">1049</a> | <a href="https://web.archive.org/web/20061107014000/http://www.nastyhost.com/members/sovsem/" title="http://www.nastyhost.com/members/sovsem/">1043</a> | <a href="https://web.archive.org/web/20061107014000/http://www.hostones.com/websites/fetish/zamnoy/" title="http://www.hostones.com/websites/fetish/zamnoy/">950</a> | <a href="https://web.archive.org/web/20061107014000/http://www.hostones.com/websites/amateurs/zaebun/" title="http://www.hostones.com/websites/amateurs/zaebun/">860</a> | <a href="https://web.archive.org/web/20061107014000/http://prodaza.porkyhost.com/" title="http://prodaza.porkyhost.com/">765</a> | <a href="https://web.archive.org/web/20061107014000/http://www2.xfreehosting.com/hardcore/navsegda/" title="http://www2.xfreehosting.com/hardcore/navsegda/">700</a> | <a href="https://web.archive.org/web/20061107014000/http://glazam.sultryserver.com/" title="http://glazam.sultryserver.com/">687</a> | <a href="https://web.archive.org/web/20061107014000/http://zakovka.porkyhost.com/" title="http://zakovka.porkyhost.com/">686</a> | <a href="https://web.archive.org/web/20061107014000/http://vsemoe.sultryserver.com/" title="http://vsemoe.sultryserver.com/">676</a> | <a href="./?date=20061019#t">TrackBack(0)</a>
		</div>
</div>


	<hr class="sep">

<center>
Mizushima Kota/e-mail: i021216@coins.tsukuba.ac.jp/SKype ID: mizu_standard
</center>




<div class="footer">
Generated by <a href="https://web.archive.org/web/20061107014000/http://www.tdiary.org/">tDiary</a> version 2.0.0<br>
Powered by <a href="https://web.archive.org/web/20061107014000/http://www.ruby-lang.org/">Ruby</a> version 1.8.2
</div>
</body>
</html>
<!--
     FILE ARCHIVED ON 01:40:00 Nov 07, 2006 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 12:51:02 Jun 14, 2025.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  captures_list: 0.63
  exclusion.robots: 0.028
  exclusion.robots.policy: 0.016
  esindex: 0.013
  cdx.remote: 18.807
  LoadShardBlock: 149.035 (3)
  PetaboxLoader3.datanode: 151.55 (4)
  load_resource: 147.324
  PetaboxLoader3.resolve: 65.294
-->