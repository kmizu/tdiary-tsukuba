<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="ja-JP">
<head><script src="//archive.org/includes/athena.js" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app216.us.archive.org';v.server_ms=397;archive_analytics.send_pageview({});});</script>
<script type="text/javascript" src="https://web-static.archive.org/_static/js/bundle-playback.js?v=1B2M2Y8A" charset="utf-8"></script>
<script type="text/javascript" src="https://web-static.archive.org/_static/js/wombat.js?v=1B2M2Y8A" charset="utf-8"></script>
<script>window.RufflePlayer=window.RufflePlayer||{};window.RufflePlayer.config={"autoplay":"on","unmuteOverlay":"hidden","showSwfDownload":true};</script>
<script type="text/javascript" src="https://web-static.archive.org/_static/js/ruffle/ruffle.js"></script>
<script type="text/javascript">
    __wm.init("https://web.archive.org/web");
  __wm.wombat("http://www2.coins.tsukuba.ac.jp:80/~i021216/diary/?","20070227041020","https://web.archive.org/","web","https://web-static.archive.org/_static/",
	      "1172549420");
</script>
<link rel="stylesheet" type="text/css" href="https://web-static.archive.org/_static/css/banner-styles.css?v=1B2M2Y8A" />
<link rel="stylesheet" type="text/css" href="https://web-static.archive.org/_static/css/iconochive.css?v=1B2M2Y8A" />
<!-- End Wayback Rewrite JS Include -->

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="generator" content="tDiary 2.0.0">
	<meta http-equiv="Last-Modified" content="Mon, 26 Feb 2007 13:49:53 GMT">
	<meta http-equiv="Content-Script-Type" content="text/javascript; charset=UTF-8">
	<meta name="author" content="水島宏太">
	<link rev="made" href="mailto:hau51010{at}tree.odn.ne.jp">
	<link rel="index" title="トップ" href="http://www.coins.tsukuba.ac.jp/~i021216/">
	<link rel="start" title="最新" href="./">
	<meta http-equiv="content-style-type" content="text/css">
	<link rel="stylesheet" href="/web/20070227041020cs_/http://www2.coins.tsukuba.ac.jp/~i021216/diary/theme/base.css" type="text/css" media="all">
	<link rel="stylesheet" href="/web/20070227041020cs_/http://www2.coins.tsukuba.ac.jp/~i021216/diary/theme/another_blue/another_blue.css" title="another_blue" type="text/css" media="all">
	<title>Onion開発日記</title>
	
	<!--link rel="alternate" type="application/x-lirs" title="lirs" href="antenna.lirs"-->
	<link rel="alternate" type="application/rss+xml" title="RSS" href="https://web.archive.org/web/20070227041020/http://www2.coins.tsukuba.ac.jp/~i021216/diary/index.rdf">
</head>
<body><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display:none;direction:ltr;" toolbar-mode="auto">
<div id="wm-ipp" style="position:fixed;left:0;top:0;right:0;">
<div id="donato" style="position:relative;width:100%;height:0;">
  <div id="donato-base">
    <iframe id="donato-if" src="https://archive.org/includes/donate.php?as_page=1&amp;platform=wb&amp;referer=https%3A//web.archive.org/web/20070227041020/http%3A//www2.coins.tsukuba.ac.jp/~i021216/diary/"
	    scrolling="no" frameborder="0" style="width:100%; height:100%">
    </iframe>
  </div>
</div><div id="wm-ipp-inside">
  <div id="wm-toolbar" style="position:relative;display:flex;flex-flow:row nowrap;justify-content:space-between;">
    <div id="wm-logo" style="/*width:110px;*/padding-top:12px;">
      <a href="/web/" title="Wayback Machine home page"><img src="https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-200.png" srcset="https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-100.png, https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-150.png 1.5x, https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-200.png 2x" alt="Wayback Machine" style="width:100px" border="0" /></a>
    </div>
    <div class="c" style="display:flex;flex-flow:column nowrap;justify-content:space-between;flex:1;">
      <form class="u" style="display:flex;flex-direction:row;flex-wrap:nowrap;" target="_top" method="get" action="/web/submit" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="http://www2.coins.tsukuba.ac.jp/~i021216/diary/" onfocus="this.focus();this.select();" style="flex:1;"/><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20070227041020" /><input type="submit" value="Go" />
      </form>
      <div style="display:flex;flex-flow:row nowrap;align-items:flex-end;">
                <div class="s" id="wm-nav-captures" style="flex:1;">
                    <a class="t" href="/web/20070227041020*/http://www2.coins.tsukuba.ac.jp/~i021216/diary/" title="See a list of every capture for this URL">77 captures</a>
          <div class="r" title="Timespan for captures of this URL">12 Sep 2004 - 19 May 2024</div>
          </div>
        <div class="k">
          <a href="" id="wm-graph-anchor">
            <div id="wm-ipp-sparkline" title="Explore captures for this URL" style="position: relative">
              <canvas id="wm-sparkline-canvas" width="750" height="27" border="0"></canvas>
            </div>
          </a>
        </div>
      </div>
    </div>
    <div class="n">
      <table>
        <tbody>
          <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
          <tr class="m">
            <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20070123020615/http://www.coins.tsukuba.ac.jp:80/~i021216/diary/" title="23 Jan 2007"><strong>Jan</strong></a></td>
            <td class="c" id="displayMonthEl" title="You are here: 04:10:20 Feb 27, 2007">FEB</td>
            <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20070408004748/http://www.coins.tsukuba.ac.jp:80/~i021216/diary/" title="08 Apr 2007"><strong>Apr</strong></a></td>
          </tr>
          <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
          <tr class="d">
            <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20070218141612/http://www.coins.tsukuba.ac.jp:80/~i021216/diary/" title="14:16:12 Feb 18, 2007"><img src="https://web-static.archive.org/_static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a></td>
            <td class="c" id="displayDayEl" style="width:34px;font-size:22px;white-space:nowrap;" title="You are here: 04:10:20 Feb 27, 2007">27</td>
            <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20070306203852/http://www.coins.tsukuba.ac.jp:80/~i021216/diary/" title="20:38:52 Mar 06, 2007"><img src="https://web-static.archive.org/_static/images/toolbar/wm_tb_nxt_on.png" alt="Next capture" width="14" height="16" border="0" /></a></td>
          </tr>
          <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
          <tr class="y">
            <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20060221173846/http://www2.coins.tsukuba.ac.jp:80/~i021216/diary/" title="21 Feb 2006"><strong>2006</strong></a></td>
            <td class="c" id="displayYearEl" title="You are here: 04:10:20 Feb 27, 2007">2007</td>
            <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20080306032224/http://www2.coins.tsukuba.ac.jp:80/~i021216/diary/" title="06 Mar 2008"><strong>2008</strong></a></td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="r" style="display:flex;flex-flow:column nowrap;align-items:flex-end;justify-content:space-between;">
      <div id="wm-btns" style="text-align:right;height:23px;">
                <span class="xxs">
          <div id="wm-save-snapshot-success">success</div>
          <div id="wm-save-snapshot-fail">fail</div>
          <a id="wm-save-snapshot-open" href="#" title="Share via My Web Archive" >
            <span class="iconochive-web"></span>
          </a>
          <a href="https://archive.org/account/login.php" title="Sign In" id="wm-sign-in">
            <span class="iconochive-person"></span>
          </a>
          <span id="wm-save-snapshot-in-progress" class="iconochive-web"></span>
        </span>
                <a class="xxs" href="http://faq.web.archive.org/" title="Get some help using the Wayback Machine" style="top:-6px;"><span class="iconochive-question" style="color:rgb(87,186,244);font-size:160%;"></span></a>
        <a id="wm-tb-close" href="#close" style="top:-2px;" title="Close the toolbar"><span class="iconochive-remove-circle" style="color:#888888;font-size:240%;"></span></a>
      </div>
      <div id="wm-share" class="xxs">
        <a href="/web/20070227041020/http://web.archive.org/screenshot/http://www2.coins.tsukuba.ac.jp/~i021216/diary/"
           id="wm-screenshot"
           title="screenshot">
          <span class="wm-icon-screen-shot"></span>
        </a>
        <a href="#" id="wm-video" title="video">
          <span class="iconochive-movies"></span>
        </a>
        <a id="wm-share-facebook" href="#" data-url="https://web.archive.org/web/20070227041020/http://www2.coins.tsukuba.ac.jp:80/~i021216/diary/" title="Share on Facebook" style="margin-right:5px;" target="_blank"><span class="iconochive-facebook" style="color:#3b5998;font-size:160%;"></span></a>
        <a id="wm-share-twitter" href="#" data-url="https://web.archive.org/web/20070227041020/http://www2.coins.tsukuba.ac.jp:80/~i021216/diary/" title="Share on Twitter" style="margin-right:5px;" target="_blank"><span class="iconochive-twitter" style="color:#1dcaff;font-size:160%;"></span></a>
      </div>
      <div style="padding-right:2px;text-align:right;white-space:nowrap;">
        <a id="wm-expand" class="wm-btn wm-closed" href="#expand"><span id="wm-expand-icon" class="iconochive-down-solid"></span> <span class="xxs" style="font-size:80%;">About this capture</span></a>
      </div>
    </div>
  </div>
    <div id="wm-capinfo" style="border-top:1px solid #777;display:none; overflow: hidden">
        <div id="wm-capinfo-notice" source="api"></div>
                <div id="wm-capinfo-collected-by">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center">COLLECTED BY</div>
    <div style="padding:3px;position:relative" id="wm-collected-by-content">
            <div style="display:inline-block;vertical-align:top;width:50%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/alexacrawls);"></span>
		Organization: <a style="color:#33f;" href="https://archive.org/details/alexacrawls" target="_new"><span class="wm-title">Alexa Crawls</span></a>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  Starting in 1996, <a href="http://www.alexa.com/">Alexa Internet</a> has been donating their crawl data to the Internet Archive.  Flowing in every day, these data are added to the <a href="http://web.archive.org/">Wayback Machine</a> after an embargo period.
	</div>
	      </div>
      <div style="display:inline-block;vertical-align:top;width:49%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/39_crawl)"></span>
		<div>Collection: <a style="color:#33f;" href="https://archive.org/details/39_crawl" target="_new"><span class="wm-title">39_crawl</span></a></div>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  this data is currently not publicly accessible.
	</div>
	      </div>
    </div>
    </div>
    <div id="wm-capinfo-timestamps">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center" title="Timestamps for the elements of this page">TIMESTAMPS</div>
    <div>
      <div id="wm-capresources" style="margin:0 5px 5px 5px;max-height:250px;overflow-y:scroll !important"></div>
      <div id="wm-capresources-loading" style="text-align:left;margin:0 20px 5px 5px;display:none"><img src="https://web-static.archive.org/_static/images/loading.gif" alt="loading" /></div>
    </div>
    </div>
  </div></div></div></div><div id="wm-ipp-print">The Wayback Machine - https://web.archive.org/web/20070227041020/http://www2.coins.tsukuba.ac.jp:80/~i021216/diary/</div>
<script type="text/javascript">//<![CDATA[
__wm.bt(750,27,25,2,"web","http://www2.coins.tsukuba.ac.jp/~i021216/diary/","20070227041020",1996,"https://web-static.archive.org/_static/",["https://web-static.archive.org/_static/css/banner-styles.css?v=1B2M2Y8A","https://web-static.archive.org/_static/css/iconochive.css?v=1B2M2Y8A"], false);
  __wm.rw(1);
//]]></script>
<!-- END WAYBACK TOOLBAR INSERT -->
 


<div class="adminmenu">
<span class="adminmenu"><a href="https://web.archive.org/web/20070227041020/http://www.coins.tsukuba.ac.jp/~i021216/">トップ</a></span>
<span class="adminmenu"><a href="update.rb">追記</a></span>
</div>
<h1>Onion開発日記</h1>
<div class="calendar">
<div class="year">2004|<a href="./?date=200409">09</a>|<a href="./?date=200410">10</a>|<a href="./?date=200411">11</a>|<a href="./?date=200412">12</a>|</div>
<div class="year">2005|<a href="./?date=200501">01</a>|<a href="./?date=200502">02</a>|<a href="./?date=200503">03</a>|<a href="./?date=200504">04</a>|<a href="./?date=200505">05</a>|<a href="./?date=200506">06</a>|<a href="./?date=200507">07</a>|<a href="./?date=200508">08</a>|<a href="./?date=200509">09</a>|<a href="./?date=200510">10</a>|<a href="./?date=200511">11</a>|<a href="./?date=200512">12</a>|</div>
<div class="year">2006|<a href="./?date=200601">01</a>|<a href="./?date=200602">02</a>|<a href="./?date=200603">03</a>|<a href="./?date=200604">04</a>|<a href="./?date=200605">05</a>|<a href="./?date=200606">06</a>|<a href="./?date=200607">07</a>|<a href="./?date=200608">08</a>|<a href="./?date=200609">09</a>|<a href="./?date=200610">10</a>|<a href="./?date=200611">11</a>|<a href="./?date=200612">12</a>|</div>
<div class="year">2007|<a href="./?date=200701">01</a>|<a href="./?date=200702">02</a>|</div>
</div>
<div class="todo">
	<div class="todo-title">
		<p>ToDo:</p>
	</div>
	<div class="todo-body">
<ul>
</ul>

	</div>
</div>


<hr class="sep">


	
<div class="day">
<h2><span class="date"><a href="./?date=20070216">2007-02-16</a></span> <span class="title"></span></h2>

<div class="body">

<div class="section">
<h3><a href="./?date=20070216#p01"><span class="sanchor">_</span></a> [<a href="./?year=2007;month=1Q;category=Java">Java</a>]RandomAccessかつListな型のみを受け付けるメソッド</h3><p>
<a href="https://web.archive.org/web/20070227041020/http://d.hatena.ne.jp/odz/20070130/1170175189#c">odz buffer</a>より引用。
</p>
<blockquote>
しかし、RandomAccess かつ List な型をうまくあらわす方法がない Java を使っているとたまに Haskell の型クラス機構がうらやましくなったりするのは自分だけだろうか。
</blockquote>
<p>
同じエントリのコメント欄。
</p>
<blockquote>
要するに、メソッドの引数が Vector と ArrayList は OK だけど、LinkedList は駄目、見たいなのを静的にチェックできない、って話です。Haskell の
method :: (List a, Randomaccess a) =&gt; a -&gt; a
みたいなメソッド宣言がしたいと。
</blockquote>
<p>
Java Genericsを使って、こんな感じで書くのはどうでしょう。型パラメータのextendsの所には複数の型を記述することができるので、それを使って「AとBの両方の型を継承している型」という制約を記述することができます。ただし、当然のことですが、単なるList型にキャストしてしまうと、RandomAccessを継承しているかどうかを静的に判定できなくなるので、このメソッドに渡すことはできなくなります。
</p>
<pre>
import java.util.*;
public class TestList {
  public static &lt;E, T extends List&lt;E&gt; &amp; RandomAccess&gt; 
    void printName(T lst) {
    System.out.println(lst.getClass().getName());
  }
  public static void main(String[] args) {
    printName(new ArrayList&lt;Object&gt;());  //OK!
    printName(new LinkedList&lt;Object&gt;()); //compile error!
  }
}
</pre></div>

</div>

<div class="comment">

	<div class="caption">[<a href="./?date=20070216#c">ツッコミを入れる</a>]</div>
</div>







		<div class="referer">
		本日のリンク元 | <a href="https://web.archive.org/web/20070227041020/http://www.google.com.pe/search?hl=es&amp;q=www.peruanitas.com&amp;meta=" title="http://www.google.com.pe/search?hl=es&amp;q=www.peruan...">319</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.nl/search?hl=nl&amp;q=wwwporna+com&amp;btnG=Google+zoeken&amp;meta=" title="http://www.google.nl/search?hl=nl&amp;q=wwwporna com&amp;b...">123</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.com/search?sourceid=navclient&amp;aq=t&amp;ie=UTF-8&amp;rlz=1T4SKPB_enBG206BG208&amp;q=facial+PORN+www%2esuper+porn%2ede+be" title="google検索(t)">94</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.com.pe/search?hl=es&amp;q=www.peruanitas.com&amp;btnG=Buscar+con+Google&amp;meta=" title="http://www.google.com.pe/search?hl=es&amp;q=www.peruan...">93</a> | <a href="https://web.archive.org/web/20070227041020/http://www.coins.tsukuba.ac.jp/~i021216/diary" title="http://www.coins.tsukuba.ac.jp/~i021216/diary">74</a> | <a href="https://web.archive.org/web/20070227041020/http://search.prodigy.msn.com/results.aspx?q=fotos+muy+chavitas+muy+ni%C3%B1itas+nenas+ni%C3%B1as&amp;FORM=SSNO" title="http://search.prodigy.msn.com/results.aspx?q=fotos...">73</a> | <a href="https://web.archive.org/web/20070227041020/http://search.alice.it/search/cgi/search.cgi?qs=www.spiagge&amp;dom=s&amp;filter=1&amp;lr=&amp;ros=%5B2%5D0,10&amp;rq1=&amp;hits=10&amp;offset=10" title="http://search.alice.it/search/cgi/search.cgi?qs=ww...">57</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.com/search?hl=pl&amp;q=darmowe+porno+z+16+latkami&amp;btnG=Szukaj+w+Google&amp;lr=" title="google検索(darmowe porno z 16 latkami)">54</a> | <a href="https://web.archive.org/web/20070227041020/http://search.sweetim.com/search.asp?src=2&amp;q=?%20wwwtutto%20gradis" title="http://search.sweetim.com/search.asp?src=2&amp;q=? www...">51</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.it/search?hl=it&amp;q=www.sexsi.it&amp;meta=" title="http://www.google.it/search?hl=it&amp;q=www.sexsi.it&amp;m...">49</a> | <a href="./?date=20070216#t">TrackBack(0)</a>
		</div>
</div>


	<hr class="sep">
	
<div class="day">
<h2><span class="date"><a href="./?date=20070204">2007-02-04</a></span> <span class="title"></span></h2>

<div class="body">

<div class="section">
<h3><a href="./?date=20070204#p01"><span class="sanchor">_</span></a> [<a href="./?year=2007;month=1Q;category=Ruby">Ruby</a>]xrubyのパーザはANTLR</h3><p>
<a href="https://web.archive.org/web/20070227041020/http://www.rubyist.net/~matz/20070131.html">Matsにっき</a>経由で、xrubyというRubyのJavaバイトコードコンパイラがあることを知ったのだが、それに関して<a href="https://web.archive.org/web/20070227041020/http://cappuccino.jp/keisuken/logbook/20070204.html#p03">航海日誌</a>の記述によると、xrubyはparserを生成するのにANTLRを使っているらしい。
</p>
<p>
で、確認のために早速xrubyのソースをダウンロードして見てみると、確かにsrc/com/xruby/compiler/parserディレクトリにruby.gというANTLRの構文定義ファイルが。Rubyみたいなややこしい文法の言語をbisonと同じLALR(1)ではなくLL(k)(ANTLRの場合は正確にはLL(*)だが) Parser Generatorで書き直すのはかなり大変なんじゃね？と思っていたので、正直驚いた。ちなみに、ruby.gの行数をカウントしてみると1616行だった。
</p></div>

</div>

<div class="comment">

		<div class="caption">本日のツッコミ(全2件) [<a href="./?date=20070204#c">ツッコミを入れる</a>]</div>
		<div class="commentshort">
				<p><a href="./?date=20070204#c01"><span class="canchor">_</span></a>
				<span class="commentator">斎藤ただし</span>&nbsp;[&gt; 書き直すのはかなり大変
 自分は逆なんだと思ってました。パーサの文法が自由な方が、同じもの書くんじゃ書きやすいん..]</p>
				<p><a href="./?date=20070204#c02"><span class="canchor">_</span></a>
				<span class="commentator">みずしま</span>&nbsp;[&gt; parse.y→ruby.gという手変換がやりにくい、ってこと?
  
 そうそう。そういうこと。JRubyが使..]</p>
		</div>
</div>







		<div class="referer">
		本日のリンク元 | <a href="https://web.archive.org/web/20070227041020/http://search.msn.com/results.aspx?srch=103&amp;FORM=AS3&amp;q=www.scambio+coppie.com." title="http://search.msn.com/results.aspx?srch=103&amp;FORM=A...">82</a> | <a href="https://web.archive.org/web/20070227041020/http://www.coins.tsukuba.ac.jp/~i021216/diary" title="http://www.coins.tsukuba.ac.jp/~i021216/diary">75</a> | <a href="https://web.archive.org/web/20070227041020/http://www.yahoogle.jp/yahoo-9-ni%C3%B1as+calatas.html" title="http://www.yahoogle.jp/yahoo-9-ni単as calatas.html">73</a> | <a href="https://web.archive.org/web/20070227041020/http://www.yahoogle.jp/yahoo-10-ni%C3%B1as+calatas.html" title="http://www.yahoogle.jp/yahoo-10-ni単as calatas.htm...">68</a> | <a href="https://web.archive.org/web/20070227041020/http://d.hatena.ne.jp/t_yano/20070128/1170006946" title="http://d.hatena.ne.jp/t_yano/20070128/1170006946">59</a> | <a href="https://web.archive.org/web/20070227041020/http://www.yahoogle.jp/yahoo-8-ni%C3%B1as+calatas.html" title="http://www.yahoogle.jp/yahoo-8-ni単as calatas.html">52</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.com.tr/search?hl=tr&amp;q=wwwporna.com&amp;meta=" title="http://www.google.com.tr/search?hl=tr&amp;q=wwwporna.c...">52</a> | <a href="https://web.archive.org/web/20070227041020/http://translate.google.com/translate_p?hl=en&amp;sl=ja&amp;u=http://www.coins.tsukuba.ac.jp/~i021216/diary/%3Fdate%3D20040925&amp;prev=/search%3Fq%3Dwww.escort.iasi%26hl%3Den%26lr%3D%26rlz%3D1T4ADBS_en___RO206%26sa%3DX" title="http://translate.google.com/translate_p?hl=en&amp;sl=j...">48</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.co.jp/search?hl=ja&amp;q=JAVA%E3%80%80%E3%83%A9%E3%83%99%E3%83%AB%E3%80%80Goto&amp;btnG=Google+%E6%A4%9C%E7%B4%A2&amp;lr=" title="google検索(JAVA　ラベル　Goto)">44</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.it/search?client=firefox-a&amp;rls=org.mozilla%3Ait%3Aofficial&amp;channel=s&amp;hl=it&amp;q=www.sexsi.it&amp;meta=&amp;btnG=Cerca+con+Google" title="http://www.google.it/search?client=firefox-a&amp;rls=o...">43</a> | <a href="./?date=20070204#t">TrackBack(0)</a>
		</div>
</div>


	<hr class="sep">
	
<div class="day">
<h2><span class="date"><a href="./?date=20070201">2007-02-01</a></span> <span class="title"></span></h2>

<div class="body">

<div class="section">
<h3><a href="./?date=20070201#p01"><span class="sanchor">_</span></a> [<a href="./?year=2007;month=1Q;category=%A5%D1%A1%BC%A5%B6%A5%B8%A5%A7%A5%CD%A5%EC%A1%BC%A5%BF">パーザジェネレータ</a>][<a href="./?year=2007;month=1Q;category=%A5%D1%A1%BC%A5%B6">パーザ</a>]パーザジェネレータ分類表/リンク集</h3><p>
ふと思い立って、パーザジェネレータの分類表/リンク集を作ってみた。とはいっても、自分が前から知っていたもの＋googleで検索して見つけて来たものだけだが。
</p>
<table border="1">
<tr>
<th>構文解析アルゴリズム／構文木の作成方式</th>
<th>semantic action</th>
<th>構文木自動生成</th>
</tr></div><div class="section">
<tr>
<th>LL系</th>
<td>
<ul>
  <li><a href="https://web.archive.org/web/20070227041020/http://javacc.dev.java.net/">JavaCC(Java)</a>
  <li><a href="https://web.archive.org/web/20070227041020/http://www.antlr.org/">ANTLR(Java,C#,C++,Python)</a>
  <li><a href="https://web.archive.org/web/20070227041020/http://www.ssw.uni-linz.ac.at/Coco/">Coco/R(Java,C#,VB,C++,Delphi, Oberon,Modula-2,Pascal,Ada,Unicon)</a>
  <li><a href="https://web.archive.org/web/20070227041020/https://a-visual-llk-parser-generator.dev.java.net/">VisualLangLab(Java)</a> 
  <li><a href="https://web.archive.org/web/20070227041020/http://www.cs.uu.nl/~daan/parsec.html">Parsec(Haskell)</a>
  <li><a href="https://web.archive.org/web/20070227041020/http://spirit.sourceforge.net/">spirit(C++)</a>
  <li><a href="https://web.archive.org/web/20070227041020/http://theory.stanford.edu/~amitp/yapps/">yapps(Python)</a>
  <li><a href="https://web.archive.org/web/20070227041020/http://hapy.sourceforge.net/">hapy(C++)</a>
  <li>cl-meta(Common Lisp,Official Site不明)
  <li>tpg(Python,Official Site不明)
</ul>
</td>
<td>
<ul>
  <li><a href="https://web.archive.org/web/20070227041020/http://javacc.dev.java.net/">JJTree(Java, JavaCC用プリプロセッサ)</a>
  <li><a href="https://web.archive.org/web/20070227041020/http://compilers.cs.ucla.edu/jtb/">JTB(Java, JavaCC用プリプロセッサ)</a>
  <li><a href="https://web.archive.org/web/20070227041020/http://www.antlr.org/">ANTLR(Java,C#,C++,Python)</a>
  <li><a href="https://web.archive.org/web/20070227041020/http://grammatica.percederberg.net/">Grammatica(Java,C#)</a>
  <li><a href="https://web.archive.org/web/20070227041020/http://home.earthlink.net/~slkpg/">SLK(Java,C#,C++,C)</a>
</ul>
</td>
</tr></div><div class="section">
<tr>
<th>LR系</th>
<td>
<ul>
  <li>perl-byacc(Perl,Official Site不明)
  <li>python-yappy(Python, Official Site不明)
  <li>ruby-byaccr(Ruby, Official Site不明)
  <li><a href="https://web.archive.org/web/20070227041020/http://dickey.his.com/byacc/byacc.html">byacc(C)</a>
  <li><a href="https://web.archive.org/web/20070227041020/http://www.gnu.org/software/bison/">bison(C)</a>
  <li><a href="https://web.archive.org/web/20070227041020/http://www005.upp.so-net.ne.jp/kmori/kmyacc/">kmyacc(C,Java,JavaScript,Perl)</a>
  <li><a href="https://web.archive.org/web/20070227041020/http://www.informatik.uni-osnabrueck.de/alumni/bernd/jay/">jay(Java)</a>
  <li><a href="https://web.archive.org/web/20070227041020/http://byaccj.sourceforge.net/">BYACC/J(Java)</a>
  <li><a href="https://web.archive.org/web/20070227041020/http://www.cs.princeton.edu/~appel/modern/java/CUP/">CUP(Java)</a>
  <li>ocamlyacc(OCaml, OCaml処理系に同梱) 
  <li><a href="https://web.archive.org/web/20070227041020/http://www.cs.berkeley.edu/~smcpeak/elkhound/">Elkhound(C++,OCaml)</a>
  <li><a href="https://web.archive.org/web/20070227041020/http://www.haskell.org/happy/">happy(Haskell)</a>
  <li><a href="https://web.archive.org/web/20070227041020/http://www.hwaci.com/sw/lemon/">LEMON(C++)</a>
  <li><a href="https://web.archive.org/web/20070227041020/http://naoyuki.hirayama.googlepages.com/caper.html">caper(C++)</a>
  <li><a href="https://web.archive.org/web/20070227041020/http://i.loveruby.net/ja/projects/racc/">racc(Ruby)</a>
  <li><a href="https://web.archive.org/web/20070227041020/http://www.cs.chalmers.se/~markus/BNFC/">bnfc(C,C++,Java,Haskell)</a>
  <li><a href="https://web.archive.org/web/20070227041020/http://www.siber.com/btyacc/">btyacc(C)</li>
  <li>ayacc(Ada,Official Site不明)
</ul>
</td>
<td>
<ul>
  <li><a href="https://web.archive.org/web/20070227041020/http://sablecc.org/">SableCC(Java)</a>
  <li><a href="https://web.archive.org/web/20070227041020/http://www.notava.org/notavacc/">notavacc(Java)</a>
  <li><a href="https://web.archive.org/web/20070227041020/http://www.speculate.de/styx/">styx(C)</a>
</ul>
</td>
</tr></div><div class="section">
<tr>
<th>Packrat Parsing</th>
<td>
<ul>
  <li><a href="https://web.archive.org/web/20070227041020/http://cs.nyu.edu/rgrimm/xtc/rats.html">Rats!(Java)</a>
  <li><a href="https://web.archive.org/web/20070227041020/http://pdos.csail.mit.edu/~baford/packrat/thesis/">Pappy(Haskell)</a>
  <li><a href="https://web.archive.org/web/20070227041020/http://repetae.net/computer/frisby/">Frisby(Haskell)</a>
  <li<a href="http://caml.inria.fr/cgi-bin/hump.en.cgi?contrib=363">OCaml-Packrat(OCaml)</a>
</ul>
</td>
<td>
  <a href="https://web.archive.org/web/20070227041020/http://cs.nyu.edu/rgrimm/xtc/rats.html">Rats!(Java)</a>
</td>
</tr>
</table>
<p>
追記1：M田さんから指摘していただいたjayとBYACC/Jを追加。
</p>
<p>
追記2：OCaml-Packratなんてものが見つかったので、追加。ソース見ると、Camlp4使ってOCamlで定義ファイルを書けるようにしてあるっぽい。
</p>
<p>
追記3：斎藤さんから指摘していただいたリストの一部をさらに追加。
</p>
<p>
追記4：IKeJI君から指摘していただいたリストの一部をさらに追加。
</p></div>

</div>

<div class="comment">

		<div class="caption">本日のツッコミ(全10件) [<a href="./?date=20070201#c">ツッコミを入れる</a>]</div>
		<div class="commentshort">
			<p><a href="./?date=20070201#c01">Before...</a></p>
				<p><a href="./?date=20070201#c06"><span class="canchor">_</span></a>
				<span class="commentator">斎藤ただし</span>&nbsp;[いや、前言撤回:
 en.wp.org&gt; This is a list of *notable* compiler-..]</p>
				<p><a href="./?date=20070201#c07"><span class="canchor">_</span></a>
				<span class="commentator">みずしま</span>&nbsp;[がーん。そんなページがあったのか。ショック
 &gt; http://en.wikipedia.org/wiki/List..]</p>
				<p><a href="./?date=20070201#c08"><span class="canchor">_</span></a>
				<span class="commentator">IKeJI</span>&nbsp;[でも、このおかげで、今後1年ぐらいの日記のネタに困りませんね。]</p>
				<p><a href="./?date=20070201#c09"><span class="canchor">_</span></a>
				<span class="commentator">みずしま</span>&nbsp;[月刊パーザジェネレータとかやるか？ &gt; 日記のネタ]</p>
				<p><a href="./?date=20070201#c10"><span class="canchor">_</span></a>
				<span class="commentator">斎藤ただし</span>&nbsp;[いやでも、本業に支障をきたさないようにお願いします(汗)
 # それを恐れて `diff mizu.txt wp.t..]</p>
		</div>
</div>







		<div class="referer">
		本日のリンク元 | <a href="https://web.archive.org/web/20070227041020/http://www.google.gr/search?hl=el&amp;client=firefox-a&amp;channel=s&amp;rls=org.mozilla%3Ael%3Aofficial&amp;hs=bbz&amp;q=luisana+se+gymni+foto&amp;btnG=%CE%91%CE%BD%CE%B1%CE%B6%CE%AE%CF%84%CE%B7%CF%83%CE%B7&amp;meta=" title="http://www.google.gr/search?hl=el&amp;client=firefox-a...">61</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.it/search?hl=it&amp;ie=ISO-8859-1&amp;q=www.film+phorno.it&amp;meta=" title="http://www.google.it/search?hl=it&amp;ie=ISO-8859-1&amp;q=...">58</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.com/search?sourceid=navclient&amp;hl=es&amp;ie=UTF-8&amp;rls=IBMA,IBMA:2006-41,IBMA:es&amp;q=ginger+maracay+sexy%2Econ" title="google検索(ginger maracay sexy.con)">43</a> | <a href="https://web.archive.org/web/20070227041020/http://www.coins.tsukuba.ac.jp/~i021216/diary" title="http://www.coins.tsukuba.ac.jp/~i021216/diary">38</a> | <a href="https://web.archive.org/web/20070227041020/http://www.yahoogle.jp/yahoo-9-ni%C3%B1as+calatas.html" title="http://www.yahoogle.jp/yahoo-9-ni単as calatas.html">34</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.it/" title="http://www.google.it/">32</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.it/search?hl=it&amp;q=www.stalloni.it&amp;meta=" title="http://www.google.it/search?hl=it&amp;q=www.stalloni.i...">25</a> | <a href="https://web.archive.org/web/20070227041020/http://search.yahoo.com/search?fr=sbc-web&amp;tab=&amp;p=wwwgatitas.com" title="http://search.yahoo.com/search?fr=sbc-web&amp;tab=&amp;p=w...">23</a> | <a href="https://web.archive.org/web/20070227041020/http://www.coins.tsukuba.ac.jp/~hdk/hina/" title="http://www.coins.tsukuba.ac.jp/~hdk/hina/">22</a> | <a href="https://web.archive.org/web/20070227041020/http://d.hatena.ne.jp/ddk50/" title="http://d.hatena.ne.jp/ddk50/">20</a> | <a href="./?date=20070201#t">TrackBack(0)</a>
		</div>
</div>


	<hr class="sep">
	
<div class="day">
<h2><span class="date"><a href="./?date=20070126">2007-01-26</a></span> <span class="title"></span></h2>

<div class="body">

<div class="section">
<h3><a href="./?date=20070126#p01"><span class="sanchor">_</span></a> [<a href="./?year=2007;month=1Q;category=%A5%D1%A1%BC%A5%B6">パーザ</a>]Packrat Parsingの嬉しさ</h3><p>
1/13のエントリのコメント欄で、斎藤ただしさんから
</p>
<blockquote>
こういうのは、Rats! or Packrat一般であるからやりやすい、みたいなところがあるのでしょうか
</blockquote>
<p>
というツッコミがあり、それに対して後で説明するということを書きつつ、今日まで説明してこなかったが、これから説明してみることにする。とはいえ、これから説明するのはPackrat Parsingの利点のうちのほんの一部なので、その辺は注意していただきたい。
</p>
<p>
まず前提として、今日一般的に使われている、プログラミング言語用の多くの構文解析アルゴリズムでは、<strong>構文解析アルゴリズムの都合上</strong>、構文解析より前の段階で字句解析処理を行う必要がある。字句解析は、よく知られているように、文字の列を解析し単語(トークン)の列に分解するという処理だが、このとき、文字列リテラルなど、<strong>開始記号 任意の文字の繰り返し 終了記号</strong>という並びになるものは通常、ここで処理され、単一のトークンになる。
</p>
<p>
さて、Rubyなどのスクリプト言語では、文字列リテラルの中に任意の式を埋め込む構文をサポートしているものがある。Rubyなら、"1 + 1 = #{1 + 1}"といった具合だ。
</p>
<p>
このような構文を扱う場合、文字列リテラルという字句解析で処理される構造の中に式という構文解析で処理される構造が埋め込まれているという点が問題になる。一般的に字句解析器は構文解析器とは分離しているため、字句解析器はその言語の構文を知らない。また、通常の字句解析器生成系(lexなど)は正規言語しか扱うことができないため、式のようにネストした構造を扱うことができない。このような構文を扱うためには、たとえば字句解析器と構文解析器が連携する必要がある。具体的には、字句解析器に文字列中であるか通常の式の中であるかという状態を持たせ、構文解析器の方から、文字列リテラル中で埋め込み式の開始位置に到達したときに「ここから式が始まるよー」というイベントを伝えて、字句解析器の状態を明示的に遷移させてやる必要がある。
</p>
<p>
一方、Packrat Parsingは字句解析という前処理が存在せず、文字列をそのまま構文解析することができる構文解析アルゴリズムである。そのため、上のような式を埋め込み可能な文字列リテラルも単純に、'"' ('#{' 式 '}' | 文字)* '"'のような構文として記述することができる。
</p>
<p>
他にも無限長の先読みをサポートしているとかバックトラックがあるとか嬉しい点があるのだが、とりあえずはここまで。
</p></div>

</div>

<div class="comment">

		<div class="caption">本日のツッコミ(全10件) [<a href="./?date=20070126#c">ツッコミを入れる</a>]</div>
		<div class="commentshort">
			<p><a href="./?date=20070126#c01">Before...</a></p>
				<p><a href="./?date=20070126#c06"><span class="canchor">_</span></a>
				<span class="commentator">みずしま</span>&nbsp;[&gt; なんか2つ(flex+bison)が1つで済んで「簡単」でかつ
 &gt; 「柔軟」?
 &gt; て、画期的だ。時代ハ進ン..]</p>
				<p><a href="./?date=20070126#c07"><span class="canchor">_</span></a>
				<span class="commentator">M田</span>&nbsp;[&gt; LexのかわりにYaccを使えば、Yaccだけで完結するかな？ 
 
 字句レベルパーザは、yylex()の本体..]</p>
				<p><a href="./?date=20070126#c08"><span class="canchor">_</span></a>
				<span class="commentator">斎藤ただし</span>&nbsp;[みずしまくん&gt; JavaCCとかANTLRとか
 みずしまくん&gt; SableCCとか
 
 なるほど、だからJava..]</p>
				<p><a href="./?date=20070126#c09"><span class="canchor">_</span></a>
				<span class="commentator">rui</span>&nbsp;[どうもはじめまして。植山といいます。Gauche向けのPEGコンビネータパーザを作っていたりします。
 http:/..]</p>
				<p><a href="./?date=20070126#c10"><span class="canchor">_</span></a>
				<span class="commentator">みずしま</span>&nbsp;[どうもはじめまして。確かに今回述べている利点は、
 Packrat Parserそのものというより、PEGパーザの利..]</p>
		</div>
</div>







		<div class="referer">
		本日のリンク元 | <a href="https://web.archive.org/web/20070227041020/http://search.msn.it/previewx.aspx?q=grassone+arrapate+con+grossi+clitoridi+sporgenti&amp;FORM=CBPW&amp;first=1&amp;noredir=1" title="http://search.msn.it/previewx.aspx?q=grassone arra...">40</a> | <a href="https://web.archive.org/web/20070227041020/http://d.hatena.ne.jp/t_yano/20070128/1170006946" title="http://d.hatena.ne.jp/t_yano/20070128/1170006946">38</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.com/search?ie=UTF-8&amp;oe=UTF-8&amp;sourceid=navclient&amp;gfns=1&amp;q=wwwsexi+tv+pl" title="google検索(wwwsexi tv pl)">34</a> | <a href="https://web.archive.org/web/20070227041020/http://buscador.aol.com/aol/search?query=wwwunivicion.com&amp;page=2&amp;Stage=0&amp;invocationType=topsearchbox.%2Faol%2Fjsp%2Fsearch.jsp" title="http://buscador.aol.com/aol/search?query=wwwunivic...">32</a> | <a href="https://web.archive.org/web/20070227041020/http://search.msn.fr/results.aspx?q=solomio.hl&amp;FORM=DNSERR" title="http://search.msn.fr/results.aspx?q=solomio.hl&amp;FOR...">27</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.it/search?hl=it&amp;q=www.stalloni.it&amp;meta=" title="http://www.google.it/search?hl=it&amp;q=www.stalloni.i...">26</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.es/search?q=onion+turismo+en+espa%C3%B1a&amp;hl=es&amp;start=10&amp;sa=N" title="http://www.google.es/search?q=onion turismo en esp...">26</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.com/search?q=www.mis+dibujos.com" title="google検索(www.mis dibujos.com)">26</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.com/search?hl=it&amp;q=pedos+porno&amp;btnG=Cerca+con+Google&amp;lr=lang_it" title="google検索(pedos porno)">26</a> | <a href="https://web.archive.org/web/20070227041020/http://www2.coins.tsukuba.ac.jp/?date=20060510" title="http://www2.coins.tsukuba.ac.jp/?date=20060510">24</a> | <a href="./?date=20070126#t">TrackBack(0)</a>
		</div>
</div>


	<hr class="sep">
	
<div class="day">
<h2><span class="date"><a href="./?date=20070118">2007-01-18</a></span> <span class="title"></span></h2>

<div class="body">

<div class="section">
<h3><a href="./?date=20070118#p01"><span class="sanchor">_</span></a> [<a href="./?year=2007;month=1Q;category=Java">Java</a>]<a href="https://web.archive.org/web/20070227041020/http://d.hatena.ne.jp/nowokay/20070118">JDK6 b105のバグ、修正済</a></h3><p>
先日のエントリで話題にしたJDK6のバグだが、既に修正コードができているらしい。
</p>
<p>
<a href="https://web.archive.org/web/20070227041020/http://d.hatena.ne.jp/nowokay/20070118">きしだのはてな</a>から引用：
</p>
<blockquote>
神谷さんによれば、すでにコードは修正されたとのこと。
<br>
http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6512534
</blockquote>
<p>
ということで、一安心。それにしても、対応早いなあ。
</p></div>

</div>

<div class="comment">

	<div class="caption">[<a href="./?date=20070118#c">ツッコミを入れる</a>]</div>
</div>







		<div class="referer">
		本日のリンク元 | <a href="https://web.archive.org/web/20070227041020/http://search.latam.msn.com/results.aspx?srch=105&amp;FORM=AS5&amp;q=sexso++en++el++adolecente++de++13+a+18++a%c3%b1os" title="http://search.latam.msn.com/results.aspx?srch=105&amp;...">84</a> | <a href="https://web.archive.org/web/20070227041020/http://www.hello.com.mx/search/wwwunivicion.com-belleza-con-mujer" title="http://www.hello.com.mx/search/wwwunivicion.com-be...">68</a> | <a href="https://web.archive.org/web/20070227041020/http://www.hello.com.mx/search/wwwunivicion.com-videos-de-mucica-gratis" title="http://www.hello.com.mx/search/wwwunivicion.com-vi...">40</a> | <a href="https://web.archive.org/web/20070227041020/http://search.msn.de/results.asp?srch=5&amp;q=http%2f%2f.www.foto+galeri&amp;first=21&amp;FORM=PERE2" title="http://search.msn.de/results.asp?srch=5&amp;q=http//.w...">29</a> | <a href="https://web.archive.org/web/20070227041020/http://search.live.com/results.aspx?mkt=it-it&amp;FORM=TOOLBR&amp;q=www.rocco+siffredi.i" title="http://search.live.com/results.aspx?mkt=it-it&amp;FORM...">28</a> | <a href="https://web.archive.org/web/20070227041020/http://www.coins.tsukuba.ac.jp/~hdk/hina/" title="http://www.coins.tsukuba.ac.jp/~hdk/hina/">25</a> | <a href="https://web.archive.org/web/20070227041020/http://espanol.search.yahoo.com/search?p=Incesto+Filial+Padre+e+hijas+Lesbicas&amp;ei=UTF-8&amp;fr=ieas&amp;x=wrt" title="http://espanol.search.yahoo.com/search?p=Incesto F...">24</a> | <a href="https://web.archive.org/web/20070227041020/http://search.msn.de/results.asp?FORM=AS35&amp;srch=5&amp;q=http%2f%2fwwwfoto+galeri" title="http://search.msn.de/results.asp?FORM=AS35&amp;srch=5&amp;...">23</a> | <a href="https://web.archive.org/web/20070227041020/http://search.prodigy.msn.com/results.aspx?q=www.wwe+en+espanol.com&amp;FORM=MSNH&amp;srch_type=0" title="http://search.prodigy.msn.com/results.aspx?q=www.w...">22</a> | <a href="https://web.archive.org/web/20070227041020/http://www.cyanet.jp/a/" title="http://www.cyanet.jp/a/">21</a> | <a href="./?date=20070118#t">TrackBack(0)</a>
		</div>
</div>


	<hr class="sep">
	
<div class="day">
<h2><span class="date"><a href="./?date=20070113">2007-01-13</a></span> <span class="title"></span></h2>

<div class="body">

<div class="section">
<h3><a href="./?date=20070113#p01"><span class="sanchor">_</span></a> [<a href="./?year=2007;month=1Q;category=Fortress">Fortress</a>]配列リテラル</h3><p>
Fortressは、普通のプログラミング言語ですから、当然配列を使えるわけです。配列型の変数の宣言構文は次のような感じで、これはまあ全然すごくないというか普通です。ちなみに、ZZ32は32bit整数型です。Fotressの言語仕様をちゃんと読んだわけじゃないので、間違ってる可能性もありますが、とりあえず整数型であることは間違いないようです。
</p>
<pre>
arr :ZZ32[3, 3] (* 3*3の2次元配列を宣言 *)
</pre>
<p>
さて、配列をあらかじめ決まった要素で初期化するのにいちいち順番に代入していくのは面倒ですから、Fortressでも他言語のように配列のリテラル表記を使うことができます。
</p>
<pre>
arr :ZZ32[3, 3] = [ 9 8 7
                    6 5 4
                    3 2 1 ]
</pre>
<p>
改行によって配列の行の終わりを示せるというのは、まあ良いでしょう。面白いのは、配列の要素のセパレータとして空白を使うことができるところです。え、面白く無い？いやいや、前回のFortressに関するエントリに書いたのですが、Fotressではx yのように空白で区切って式を並べて書くことで、乗算を書くことができるのです。Fortressの配列リテラルの中では、通常の計算式を書くことができますから、単純に考えて文法を設計したら、
</p>
<pre>
arr :ZZ32[3, 3] = [ (9 8 7)
                    (6 5 4)
                    (3 2 1) ]
</pre>
<p>
のように解釈されてしまうと思うわけです。で、こんな文法になっているということは、「配列リテラルの中に出現する式」だけを特別扱いしているに違い無いと思い、Rats!で書かれたFortressの文法を読んでいたら、案の定そうなっていました。Literal.ratsファイルから該当すると思われる箇所を引用すると、
</p>
<pre>
Expr Literal =
     openparen w closeparen
     { yyValue = new VoidLiteral(createSpan(yyStart,yyCount)); }
   / yyValue:NumericLiteral
   / yyValue:CharLiteral
   / yyValue:StringLiteral
   / opencurly w a1:Entry a2s:(w comma w Entry)* w closecurly
     { List&lt;com.sun.fortress.interpreter.useful.Pair&lt;Expr,Expr&gt;&gt; elements =
           new ArrayList&lt;com.sun.fortress.interpreter.useful.Pair&lt;Expr,Expr&gt;&gt;();
       elements.add(new com.sun.fortress.interpreter.useful.Pair&lt;Expr,Expr&gt;(a1.getKey(), a1.getValue()));
       for (Entry e : (List&lt;Entry&gt;)a2s.list()) {
           elements.add(new com.sun.fortress.interpreter.useful.Pair&lt;Expr,Expr&gt;(e.getKey(), e.getValue()));
       }
       yyValue = new MapExpr(createSpan(yyStart,yyCount), elements);
     }
   / <font color="red">opensquare w yyValue:RectElements w closesquare</font> ;
<br>
/* RectElements ::= NoSpaceExpr MultiDimCons* */
<font color="red">MultiDim RectElements =
     a1:NoSpaceExpr a2s:MultiDimCons*</font>
     { if (a2s == null || a2s.isEmpty())
           yyValue = new MultiDimElement(a1.getSpan(), a1);
       else
           yyValue = FortressUtil.multiDimCons(a1, a2s.list());
     };
<br>
/* MultiDimCons ::= RectSeparator NoSpaceExpr */
com.sun.fortress.interpreter.useful.Pair&lt;Integer,Expr&gt; MultiDimCons =
     a1:RectSeparator a2:NoSpaceExpr
     { yyValue = new com.sun.fortress.interpreter.useful.Pair&lt;Integer,Expr&gt;(a1,a2); };
<br>
</pre>
<p>
赤字で強調したところがポイントで、おそらく配列リテラル中では「NoSpaceExpr」だけが出現できるということなんでしょう。で、この「NoSpaceExpr」が一体何なのかということですが、これは定義が複雑なのでとりあえず置いておきますが、ただ単に「スペースを含まない式」では無いようです。というのは、スペースで区切った式でも()で囲むことで配列リテラル中に書けるからです。
</p></div>

</div>

<div class="comment">

		<div class="caption">本日のツッコミ(全3件) [<a href="./?date=20070113#c">ツッコミを入れる</a>]</div>
		<div class="commentshort">
				<p><a href="./?date=20070113#c01"><span class="canchor">_</span></a>
				<span class="commentator">斎藤ただし</span>&nbsp;[こういうのは、Rats! or Packrat一般であるからやりやすい、みたいなところがあるのでしょうか(という素人..]</p>
				<p><a href="./?date=20070113#c02"><span class="canchor">_</span></a>
				<span class="commentator">Ryo</span>&nbsp;[Fortressの並列化支援やらについてのエントリきぼんです
 
 #なんかうさんくさいんですよねー]</p>
				<p><a href="./?date=20070113#c03"><span class="canchor">_</span></a>
				<span class="commentator">みずしま</span>&nbsp;[斎藤ただしさん：
 &gt; Rats! or Packrat一般であるからやりやすい、みたいなところ
 
 これについて..]</p>
		</div>
</div>







		<div class="referer">
		本日のリンク元 | <a href="https://web.archive.org/web/20070227041020/http://search.conduit.com/ResultsExt.aspx?ctid=CT612874&amp;q=troievecchie" title="http://search.conduit.com/ResultsExt.aspx?ctid=CT6...">44</a> | <a href="https://web.archive.org/web/20070227041020/http://www.hello.com.mx/search/wwwunivicion.com-videos-de-mucica-gratis" title="http://www.hello.com.mx/search/wwwunivicion.com-vi...">33</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.com/search?q=www.la+mega.com.ar" title="google検索(www.la mega.com.ar)">26</a> | <a href="https://web.archive.org/web/20070227041020/http://search.msn.es/results.aspx?q=wwwbideos+xxx+.com+.pe&amp;FORM=MSNH&amp;srch_type=0" title="http://search.msn.es/results.aspx?q=wwwbideos xxx ...">19</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.it/search?hl=it&amp;q=www.bulma++nuda+++che++fa++sesso.it&amp;btnG=Cerca&amp;meta=" title="http://www.google.it/search?hl=it&amp;q=www.bulma  nud...">17</a> | <a href="https://web.archive.org/web/20070227041020/http://reader.livedoor.com/reader/" title="http://reader.livedoor.com/reader/">17</a> | <a href="https://web.archive.org/web/20070227041020/http://search.yahoo.co.jp/search?p=videos+de+super+porno+de+sexo+anal+con+menores+de+edad+&amp;fr=top_v2&amp;tid=top_v2&amp;ei=euc-jp&amp;search.x=1&amp;x=14&amp;y=14" title="http://search.yahoo.co.jp/search?p=videos de super...">16</a> | <a href="https://web.archive.org/web/20070227041020/http://search.live.com/results.aspx?mkt=de-de&amp;FORM=TOOLBR&amp;q=www.amore+tv.de" title="http://search.live.com/results.aspx?mkt=de-de&amp;FORM...">16</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.com/search?hl=ar&amp;q=www.nancy+chat.net&amp;btnG=%D8%A8%D8%AD%D8%AB+Google&amp;lr=" title="google検索(www.nancy chat.net)">14</a> | <a href="https://web.archive.org/web/20070227041020/http://search.msn.se/results.aspx?srch=105&amp;FORM=AS5&amp;q=www.eniro.se+chihuahua" title="http://search.msn.se/results.aspx?srch=105&amp;FORM=AS...">14</a> | <a href="./?date=20070113#t">TrackBack(0)</a>
		</div>
</div>


	<hr class="sep">
	
<div class="day">
<h2><span class="date"><a href="./?date=20070112">2007-01-12</a></span> <span class="title"></span></h2>

<div class="body">

<div class="section">
<h3><a href="./?date=20070112#p01"><span class="sanchor">_</span></a> [<a href="./?year=2007;month=1Q;category=Java">Java</a>]SunのJVM(Java6 b105)のバグ？</h3><p>
<a href="https://web.archive.org/web/20070227041020/http://d.hatena.ne.jp/nowokay/20070111#c">きしだのはてな</a>より引用：
</p>
<blockquote>
<p>
再現できる最低限まで削っていったら、めちゃくちゃシンプルで誰でも書いていそうなコードになりました。
びっくりします。ローカル変数の定義順を変えると挙動が変わるところが一番のみどころです。
</p>
<p>
こんな感じです。Tomcat5.5.17+Java6 b105で確認してます。
5回くらいリロードすると結果が変わります。
最後の空ループの回数を少なくすると、現象が発生するまでのリロード回数が変わります。
</p>
<pre>
package servlets;
<br>
import java.io.*;
import javax.servlet.http.*;
public class ProblemServlet extends HttpServlet {
    protected void doGet
            (HttpServletRequest request, HttpServletResponse response)
            throws IOException 
    {
        response.setContentType("text/html");
        PrintWriter out = response.getWriter();
        boolean brk = true;//preと順番を逆にすると再現しない
        boolean pre = false;
        for(int i = 0; i &lt; 3; ++i){
            int j = 0;
            while(j &lt; 1){
                ++j;
                System.out.println("ループ先頭: " + pre);
                if(i == 0){
                    pre = brk;
                    brk = false;
                    System.out.println("continue:" + pre);
                    continue;
                }
                if(i == 1) brk = pre;
                out.println(i);
                if(brk) out.println("&lt;br&gt;");
            }
        }
        for(int i = 0; i &lt; 1000; ++i);
<br>        
        out.close();
    }
}
</pre>
<p>
変数preはif(i == 0)の中でしか変更してないので、「continue」の後の「ループ先頭」での値は必ず同じになるはずです。
でも、結果が変わったときには、continueしたあとでpreの値が変わっていることがわかります。
whileを通常のfor(int j = 0; j &lt; 1; ++j)の形にすると再現しません。continueの処理がくさいです。
</p>
</blockquote>
<p>
マジデスカ？本当に再現するなら、かなりやばいバグですね。というわけで、自宅のPC環境(Windows XP, Java6 b105)で現象を再現できるかどうか試してみました。とはいっても、サーブレットのリロードだと再現を確認するのが面倒だし、再現できたかどうかに確信が持ちにくいので、スタンドアロンのプログラムを作って再現できるかどうか確認してみました。
</p>
<p>
…再現できちゃいました。現象を再現するコードは以下の通り。元のコードをさらに削って、バグであることがわかりやすいようにしてみました。
</p>
<pre>
public class BuggyAction {
  protected static void doSomething() {
    boolean brk = true;//preと順番を逆にすると再現しない
    boolean pre = false;
    java.util.List&lt;String&gt; messages = new java.util.ArrayList&lt;String&gt;();
    for(int i = 0; i &lt; 3; ++i){
      int j = 0;
      messages.add("pre(for loop):            " + pre);
      while(j &lt; 1){
        ++j;
        messages.add("pre(while loop):          " + pre);
        if(i == 0){
          pre = brk;
          brk = false;
          messages.add("pre(while loop continue): " + pre);
          continue;
        }
      }
    }
    for(String message : messages) System.out.println(message);
    //-XX:CompileThreshold=1にすると、この部分は無くても現象が再現。
    //やっぱりJITコンパイラの部分の不具合か？
    for(int i = 0; i &lt; 1000; ++i);
  }
  public static void main(String[] args) {
    //i == 3くらいで現象が発生
    for(int i = 0; i &lt; 5; i++){
      doSomething();
      System.out.println("----------------------");
    }
  }
}
</pre>
<p>
実行結果は以下の通り。青い字の部分と赤い字の部分に注目。
</p>
<pre>
pre(for loop):            false
pre(while loop):          false
pre(while loop continue): true
pre(for loop):            true
pre(while loop):          true
pre(for loop):            true
pre(while loop):          true
----------------------
pre(for loop):            false
pre(while loop):          false
pre(while loop continue): true
pre(for loop):            true
pre(while loop):          true
pre(for loop):            true
pre(while loop):          true
----------------------
pre(for loop):            false
pre(while loop):          false
<font color="blue">pre(while loop continue): true</font>
<font color="blue">pre(for loop):            true</font>
pre(while loop):          true
pre(for loop):            true
pre(while loop):          true
----------------------
pre(for loop):            false
pre(while loop):          false
<font color="red">pre(while loop continue): true</font>
<font color="red">pre(for loop):            false</font>
pre(while loop):          false
pre(for loop):            false
pre(while loop):          false
----------------------
pre(for loop):            false
pre(while loop):          false
pre(while loop continue): true
pre(for loop):            false
pre(while loop):          false
pre(for loop):            false
pre(while loop):          false
----------------------
</pre>
<p>
再び引用：
</p>
<blockquote>
こんだけ最適化したことでプログラマとしての満足感が得られてしまったので、バグデータベースへの報告はたぶんかなり後回しになると思います。もしそういうのが得意な方がいらっしゃったら、代わりに報告していただけるとありがたいです。こんだけ簡単なコードで再現するので、すでに報告されているかもしれません。
</blockquote>
<p>
<a href="https://web.archive.org/web/20070227041020/http://bugs.sun.com/bugdatabase/index.jsp">SunのBug Database</a>を検索してみましたが、私が検索した限りでは該当するバグは見つけることができませんでした。私にできるなら、バグデータベースへの報告をしたいところですが、いかんせん英語能力が…orz。
<p>
追記：さらにコードを改造して、どの段階でpreが書き換わったのかをより詳しく調べてみました。どうやら、continue直後のwhileループの継続条件条件チェックの所で、既にpreが書き換わってしまっているようです。
</p>
<pre>
public class BuggyAction {
  private static boolean p(java.util.List&lt;String&gt; list, String header, boolean arg) {
    list.add(header + arg);
    return true;
  }
  protected static void doSomething() {
    boolean brk = true;//preと順番を逆にすると再現しない
    boolean pre = false;
    java.util.List&lt;String&gt; messages = new java.util.ArrayList&lt;String&gt;();
    for(int i = 0; i &lt; 3; ++i){
      boolean shouldContinue = true;
      messages.add("pre(for loop):            " + pre);
      while(p(messages, "pre(while loop cond):     ", pre) &amp;&amp; shouldContinue){
        shouldContinue = false;
        messages.add("pre(while loop):          " + pre);
        if(i == 0){
          pre = brk;
          brk = false;
          messages.add("pre(while loop continue): " + pre);
          continue;
        }
      }
      messages.add("pre(for loop last):       " + pre);
    }
    for(String message : messages) System.out.println(message);
    //-XX:CompileThreshold=1にすると、この部分は無くても現象が再現。
    //やっぱりJITコンパイラの部分の不具合か？
    for(int i = 0; i &lt; 1000; ++i);
  }
  public static void main(String[] args) {
    //i == 3くらいで現象が発生
    for(int i = 0; i &lt; 5; i++){
      doSomething();
      System.out.println("----------------------");
    }
  }
}
</pre>
<p>
実行結果：
</p>
<pre>
pre(for loop):            false
pre(while loop cond):     false
pre(while loop):          false
pre(while loop continue): true
pre(while loop cond):     true
pre(for loop last):       true
pre(for loop):            true
pre(while loop cond):     true
pre(while loop):          true
pre(while loop cond):     true
pre(for loop last):       true
pre(for loop):            true
pre(while loop cond):     true
pre(while loop):          true
pre(while loop cond):     true
pre(for loop last):       true
----------------------
pre(for loop):            false
pre(while loop cond):     false
pre(while loop):          false
pre(while loop continue): true
pre(while loop cond):     true
pre(for loop last):       true
pre(for loop):            true
pre(while loop cond):     true
pre(while loop):          true
pre(while loop cond):     true
pre(for loop last):       true
pre(for loop):            true
pre(while loop cond):     true
pre(while loop):          true
pre(while loop cond):     true
pre(for loop last):       true
----------------------
pre(for loop):            false
pre(while loop cond):     false
pre(while loop):          false
<font color="blue">pre(while loop continue): true</font>
<font color="blue">pre(while loop cond):     true</font>
pre(for loop last):       true
pre(for loop):            true
pre(while loop cond):     true
pre(while loop):          true
pre(while loop cond):     true
pre(for loop last):       true
pre(for loop):            true
pre(while loop cond):     true
pre(while loop):          true
pre(while loop cond):     true
pre(for loop last):       true
----------------------
pre(for loop):            false
pre(while loop cond):     false
pre(while loop):          false
<font color="red">pre(while loop continue): true</font>
<font color="red">pre(while loop cond):     false</font>
pre(for loop last):       false
pre(for loop):            false
pre(while loop cond):     false
pre(while loop):          false
pre(while loop cond):     false
pre(for loop last):       false
pre(for loop):            false
pre(while loop cond):     false
pre(while loop):          false
pre(while loop cond):     false
pre(for loop last):       false
----------------------
pre(for loop):            false
pre(while loop cond):     false
pre(while loop):          false
pre(while loop continue): true
pre(while loop cond):     false
pre(for loop last):       false
pre(for loop):            false
pre(while loop cond):     false
pre(while loop):          false
pre(while loop cond):     false
pre(for loop last):       false
pre(for loop):            false
pre(while loop cond):     false
pre(while loop):          false
pre(while loop cond):     false
pre(for loop last):       false
----------------------
</pre></div>

</div>

<div class="comment">

		<div class="caption">本日のツッコミ(全9件) [<a href="./?date=20070112#c">ツッコミを入れる</a>]</div>
		<div class="commentshort">
			<p><a href="./?date=20070112#c01">Before...</a></p>
				<p><a href="./?date=20070112#c05"><span class="canchor">_</span></a>
				<span class="commentator">M田</span>&nbsp;[Windows版では再現しました。もっと短いコード（doSomethingのみ)
 :
 
   protected..]</p>
				<p><a href="./?date=20070112#c06"><span class="canchor">_</span></a>
				<span class="commentator">M田</span>&nbsp;[とりあえずレポートしてみました。]</p>
				<p><a href="./?date=20070112#c07"><span class="canchor">_</span></a>
				<span class="commentator">Weresadws</span>&nbsp;[weight loss hypnosis
 http://phentermineovernight.ksiegago..]</p>
				<p><a href="./?date=20070112#c08"><span class="canchor">_</span></a>
				<span class="commentator">Joesadws</span>&nbsp;[All about side effecte  phentermine
 &lt;link=http://www.priv..]</p>
				<p><a href="./?date=20070112#c09"><span class="canchor">_</span></a>
				<span class="commentator">buy viagra you</span>&nbsp;[I'm buy viagra online at http://buy-viagra-online1.8l.pl/ ..]</p>
		</div>
</div>







		<div class="referer">
		本日のリンク元 | <a href="https://web.archive.org/web/20070227041020/http://search.yahoo.com/search?p=wwwftv.com&amp;ei=UTF-8&amp;xargs=0&amp;pstart=1&amp;b=21" title="http://search.yahoo.com/search?p=wwwftv.com&amp;ei=UTF...">33</a> | <a href="https://web.archive.org/web/20070227041020/http://d.hatena.ne.jp/nowokay/20070111" title="http://d.hatena.ne.jp/nowokay/20070111">30</a> | <a href="https://web.archive.org/web/20070227041020/http://d.hatena.ne.jp/nowokay/" title="http://d.hatena.ne.jp/nowokay/">24</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.com/search?q=www.la+mega.com.ar" title="google検索(www.la mega.com.ar)">17</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.com/custom?q=wwwmujere+cogiendo%2Ccom&amp;sa=Search&amp;client=pub-6807258685122891&amp;forid=1&amp;channel=6646959924&amp;ie=ISO-8859-1&amp;oe=ISO-8859-1&amp;cof=GALT%3A%23008000%3BGL%3A1%3BDIV%3A%23336699%3BVLC%3A663399%3BAH%3Acenter%3BBGC%3AFFFFFF%3BLBGC%3A336699%3BALC%3A0000FF%3BLC%3A0000FF%3BT%3A000000%3BGFNT%3A0000FF%3BGIMP%3A0000FF%3BLH%3A74%3BLW%3A163%3BL%3Ahttp%3A%2F%2Fwww.google.com%2Fintl%2Fen%2Flogos%2FLogo_50wht.gif%3BS%3Ahttp%3A%2F%2Fwww.google.com%3BLP%3A1%3BFORID%3A1%3B&amp;hl=en" title="http://www.google.com/custom?q=wwwmujere cogiendo,...">15</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.com.mx/search?q=imagenes+de+perversiones+japonesas&amp;hl=es&amp;lr=&amp;start=240&amp;sa=N" title="http://www.google.com.mx/search?q=imagenes de perv...">14</a> | <a href="https://web.archive.org/web/20070227041020/http://search.msn.es/results.asp?FORM=AS35&amp;srch=5&amp;q=mujeres+pariendo+videogratis" title="http://search.msn.es/results.asp?FORM=AS35&amp;srch=5&amp;...">14</a> | <a href="https://web.archive.org/web/20070227041020/http://galacticforum.com/" title="http://galacticforum.com">14</a> | <a href="https://web.archive.org/web/20070227041020/http://search.msn.com/results.asp?FORM=AS35&amp;srch=5&amp;q=darmowefilmygay" title="http://search.msn.com/results.asp?FORM=AS35&amp;srch=5...">12</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.com/search?q=www.GALERIAS+GRATIS.COM&amp;hl=en&amp;lr=&amp;start=70&amp;sa=N" title="google検索(www.GALERIAS GRATIS.COM)">11</a> | <a href="./?date=20070112#t">TrackBack(0)</a>
		</div>
</div>


	<hr class="sep">
	
<div class="day">
<h2><span class="date"><a href="./?date=20070111">2007-01-11</a></span> <span class="title"></span></h2>

<div class="body">

<div class="section">
<h3><a href="./?date=20070111#p01"><span class="sanchor">_</span></a> [<a href="./?year=2007;month=1Q;category=Fortress">Fortress</a>]Hello, Fortress!</h3><p>
早速、公開されたFortressのソースをダウンロードしてきて、ビルドしてみた。まずは、ソースのルートにあるbuild.xmlをそのままantで実行してみる。
すると、assertEquals()などのjunit由来と思われる識別子が見つからないというコンパイルエラーが発生した。build.xmlを見てみると、junit.jarへのクラスパスが通っていなかったのでbuild.xmlを改変して、junit.jarへのクラスパスを通してみると今度はビルドに成功。
</p>
<p>
で、ビルドに成功したので次は実行と行きたいところだが、fortressのソースには、fortressインタプリタ実行用のシェルスクリプトが添付されていたものの、バッチファイルが無かった。しかし、自宅のPC環境はWindowsなので、シェルスクリプトはそのままでは実行できない(Cygwinとか使えば別だが)。シェルスクリプトでは、クラスパスを通してjavaコマンドを起動する程度のことしかやっていなかったので、シェルスクリプトを元に同等のことを行うバッチファイルを作成した。
</p>
<p>
ここまでで実行の準備が出来たので、最初のプログラムを実行してみる。やはり最初のプログラムと言えば、Hello, World!だろうということで、Fortressのソース中にあったhello.fssを実行してみた。
</p>
<p>
<strong>hello.fss</strong>
</p>
<pre>
component Hello
<br>
export Executable
<br>
run(args:String...) = print "Hello, World!\n"
</pre>
<pre>
fortress hello.fss
</pre>
<p>
しかし、ここで何故か
</p>
<pre>
Parse of C:\fortress\ProjectFortress\FortressLibrary.jst ended EARLY at line = 1
,  column = 27
Trouble reading preparsed library AST.
java.io.IOException: Near line 1 and column 26 got Backslash escape P(hex 50)
        at com.sun.fortress.interpreter.reader.Lex.unexpected(Lex.java:295)
        at com.sun.fortress.interpreter.reader.Lex.readQuoted(Lex.java:261)
        at com.sun.fortress.interpreter.reader.Lex.name(Lex.java:210)
</pre>
<p>
というメッセージを吐いてインタプリタが落ちてしまう。FortressLibrary.jstというファイルを見ると、どうやらFortressの基本ライブラリをAST化してファイルに保存したもののようだが、このファイルの1行目で字句解析に失敗しているようだ。で、FortressLibrary.jstの１行目を見てみると、
</p>
<pre>
(Component @"C:\fortress\ProjectFortress\FortressLibrary.fss",18:0~1019:3
</pre>
<p>
文字列中に単独で\記号が入ってしまったため、エスケープに失敗しているように見える。たぶん、開発がUnix環境上で行われていて、Windows上での実行は考慮に入れていなかったのだろう。仕方が無いので、パス名を表す文字列中の\を全部\\に置換することに。
</p>
<p>
改めて実行してみると、今度は成功。無事、以下のように"Hello, World!"が表示された。
</p>
<pre>
Parsing hello.fss with the Rats! parser: 219 milliseconds
Read C:\fortress\ProjectFortress\FortressLibrary.jst: 312 milliseconds
Hello, Fortress!
finish runProgram
671 milliseconds
</pre>
<p>
追記：間違えて、出力する文字列を"Hello, Fortress!"に変更したときの出力結果を貼り付けてしまった。
</p>
<p>
次は、階乗を計算するプログラム。r xでr * xを計算することができる。
</p>
<p>
<strong>factorial.fss</strong>
</p>
<pre>
component Factorial
<br>
export Executable
<br>
factorial(n) = do
  var r = 1
  for x &lt;- seq(1#n) do
    r := r x
  end
  r
end
<br>
run(args:String...) :() = 
  println(factorial(5))
end
</pre>
<p>
実行結果。
</p>
<pre>
Parsing factorial.fss with the Rats! parser: 218 milliseconds
Read C:\fortress\ProjectFortress\FortressLibrary.jst: 297 milliseconds
120
finish runProgram
657 milliseconds
</pre></div>

</div>

<div class="comment">

		<div class="caption">本日のツッコミ(全1件) [<a href="./?date=20070111#c">ツッコミを入れる</a>]</div>
		<div class="commentshort">
				<p><a href="./?date=20070111#c01"><span class="canchor">_</span></a>
				<span class="commentator">ささだ</span>&nbsp;[おおー]</p>
		</div>
</div>







		<div class="referer">
		本日のリンク元 | <a href="https://web.archive.org/web/20070227041020/http://cgi.search.biglobe.ne.jp/cgi-bin/search2-b?search=%8C%9F%8D%F5&amp;q=Mujeres+calatas+del+Peru+en+Castellano&amp;bt01.x=67&amp;bt01.y=11" title="BIGLOBE検索(Mujeres calatas del Peru en Castellano)">57</a> | <a href="https://web.archive.org/web/20070227041020/http://cgi.search.biglobe.ne.jp/cgi-bin/search2-b?search=%8C%9F%8D%F5&amp;q=Mujeres+calatas+del+Peru+en+Castellano&amp;bt01.x=22&amp;bt01.y=8" title="BIGLOBE検索(Mujeres calatas del Peru en Castellano)">48</a> | <a href="https://web.archive.org/web/20070227041020/http://cgi.search.biglobe.ne.jp/cgi-bin/search2-b?search=%8C%9F%8D%F5&amp;q=Mujeres+calatas+del+Peru+en+Castellano&amp;bt01.x=28&amp;bt01.y=7" title="BIGLOBE検索(Mujeres calatas del Peru en Castellano)">27</a> | <a href="https://web.archive.org/web/20070227041020/http://search.msn.it/results.aspx?q=WWW.COSE+PORNO.IT&amp;FORM=MSNH&amp;CP=65001&amp;srch_type=0&amp;mkt=it-it" title="http://search.msn.it/results.aspx?q=WWW.COSE PORNO...">18</a> | <a href="https://web.archive.org/web/20070227041020/http://search.msn.it/results.asp?FORM=AS35&amp;srch=5&amp;q=www.ragaze+tuning" title="http://search.msn.it/results.asp?FORM=AS35&amp;srch=5&amp;...">18</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.it/search?sourceid=navclient&amp;aq=t&amp;hl=it&amp;ie=UTF-8&amp;rlz=1T4GFRC_itIT203IT205&amp;q=www%2eorgasmo+gay+%2ecom%2ebr" title="http://www.google.it/search?sourceid=navclient&amp;aq=...">17</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.es/search?q=+ni%C3%B1as+14++desnudas+en+las+duchas&amp;hl=es&amp;lr=&amp;start=20&amp;sa=N" title="http://www.google.es/search?q= ni単as 14  desnudas...">16</a> | <a href="https://web.archive.org/web/20070227041020/http://cgi.search.biglobe.ne.jp/cgi-bin/search2-b?search=%8C%9F%8D%F5&amp;q=Mujeres+calatas+del+Peru+en+Castellano&amp;bt01.x=64&amp;bt01.y=20" title="BIGLOBE検索(Mujeres calatas del Peru en Castellano)">16</a> | <a href="https://web.archive.org/web/20070227041020/http://www.yahoogle.jp/yahoo-9-ni%C3%B1as+calatas.html" title="http://www.yahoogle.jp/yahoo-9-ni単as calatas.html">15</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.it/search?sourceid=navclient&amp;aq=t&amp;hl=it&amp;ie=UTF-8&amp;rlz=1T4GFRC_itIT203IT205&amp;q=www%2epaolini+hard%2ecom" title="http://www.google.it/search?sourceid=navclient&amp;aq=...">15</a> | <a href="./?date=20070111#t">TrackBack(0)</a>
		</div>
</div>


	<hr class="sep">
	
<div class="day">
<h2><span class="date"><a href="./?date=20070110">2007-01-10</a></span> <span class="title"></span></h2>

<div class="body">

<div class="section">
<h3><a href="./?date=20070110#p01"><span class="sanchor">_</span></a> [<a href="./?year=2007;month=1Q;category=Java">Java</a>]LinkedListに関する不適切な説明</h3><p>
mixiのJavaコミュニティでArrayListとLinkedListに関する議論が行われていたのだが、それに関して、ちょっと思ったこと。
</p>
<p>
よく、ArrayListとLinkedListの比較において、LinkedListはArrayListに比べて<strong>ランダムアクセスは低速</strong>だが、<strong>要素の挿入/削除は高速</strong>という説明が見られる(googleで<a href="https://web.archive.org/web/20070227041020/http://www.google.co.jp/search?hl=ja&amp;q=ArrayList+LinkedList&amp;btnG=Google+%E6%A4%9C%E7%B4%A2&amp;lr=">ArrayList LinkedListで検索する</a>と大量に出てくる)のだが、これって、かなり誤解を招く説明では無いかと思う。とはいっても、前半半分は別に間違ってはいない。確かにLinkedListのランダムアクセス性能はArrayListに比べて明らかに悪い。
</p>
<p>
問題なのは後半部分だ。平均的な入力において、LinkedListへの要素の挿入/削除は、ArrayListに比べて高速とは言えない。何故かと言えば、実はすごく当たり前の話で、ArrayListの場合は、途中への要素の挿入/削除は挿入位置より後ろの全要素をずらすため、O(n)時間かかるが、LinkedListの場合も、挿入する位置に到達するために、リンクを挿入するインデックスの数だけたどる必要があるため、結局O(n)時間かかってしまうためだ。そして、Webページの説明記事の多くは、何故かそのことをスルーして、LinkedListの場合は参照を張り替えるだけで済むためArrayListに比べて高速などのように書いてあるものが多い。
</p>
<p>
もちろん、リストの<strong>先頭あるいは先頭付近</strong>への挿入/削除が頻発する場合や、<strong>Iteratorで全要素をたどって、条件を満たしていない
要素全てを挿入/削除する場合</strong>などはLinkedListの方が高速になる。しかし、それならばリストの先頭への挿入/削除が高速あるいは、Iteratorで要素をたどりつつ挿入/削除する場合に高速と書けばいいのであって、挿入/削除を行う場合はLinkedListの方が高速と書くのは誤解を招くだけなので、やめた方がいいのではないだろうか。
</p>
<p>
ちなみに、自宅のPC(OS: Windows XP, JRE: JDK 6.0, CPU: Athlon 64 3000+, Memory: 1.5GB)でArrayListとLinkedListの性能を測定する次のような簡単なベンチマークプログラムを作って実験してみた。
</p>
<pre>
import java.util.ArrayList;
import java.util.LinkedList;
import java.util.List;
<br>
public class ListPerformance {
  private static final int NANO_MILLI = 1000000;
  private static final int DEFAULT_NUM_OF_CALLS = 100000;
  abstract static class ListBenchmark&lt;T&gt; {    
    protected String operation;
    protected int count;
    protected List&lt;T&gt; target;
    ListBenchmark(String operation, int count) {
      this.operation = operation;
      this.count = count;
    }
    protected abstract void run();
    protected void prepare(){}
    public final void measure(List&lt;T&gt; target) {
      this.target = target;
      prepare();
      long start = System.nanoTime();
      for(int i = 0; i &lt; count; i++) {
        run();
      }
      long time = (System.nanoTime() - start) / NANO_MILLI;
      System.out.printf("%7s:%6d[ms] using %s%n", operation, time, target.getClass());
    }
  }
  
  public static void main(String[] args) {
    ListBenchmark&lt;String&gt; append = new ListBenchmark&lt;String&gt;("append", DEFAULT_NUM_OF_CALLS){
      @Override
      protected void run() {
        target.add("");
      }
    };
    ListBenchmark&lt;String&gt; insert = new ListBenchmark&lt;String&gt;("insert", DEFAULT_NUM_OF_CALLS){
      @Override
      protected void run() {
        target.add(target.size() / 2, "");
      }
    };
    ListBenchmark&lt;String&gt; prepend = new ListBenchmark&lt;String&gt;("prepend", DEFAULT_NUM_OF_CALLS){
      @Override
      protected void run() {
        target.add(0, "");
      }
    };
    ListBenchmark&lt;String&gt; remove = new ListBenchmark&lt;String&gt;("remove", DEFAULT_NUM_OF_CALLS){
      @Override
      protected void prepare() {
        for(int i = 0; i &lt; count; i++){
          target.add("");
        }
      }
      @Override
      protected void run() {
        target.remove(target.size() / 2);
      }
    };
    append.measure(new ArrayList&lt;String&gt;());
    append.measure(new LinkedList&lt;String&gt;());
   
    System.gc();
    
    insert.measure(new ArrayList&lt;String&gt;());
    insert.measure(new LinkedList&lt;String&gt;());
    
    System.gc();
<br>
    prepend.measure(new ArrayList&lt;String&gt;());
    prepend.measure(new LinkedList&lt;String&gt;());
    
    System.gc();
    
    remove.measure(new ArrayList&lt;String&gt;());
    remove.measure(new LinkedList&lt;String&gt;());
<br>
  }
}
</pre>
<p>
結果は次の通り。append(末尾への追加)は両者ともほとんど同じ性能で、insert(リストの中間への要素の挿入)はArrayListの方が高速、prepend(先頭への挿入)はLinkedListの方が高速、remove(リストの中間からの要素の削除)は
ArrayListの方が高速、という結果になった。
</p>
<pre>
 append:    20[ms] using class java.util.ArrayList
 append:    21[ms] using class java.util.LinkedList
 insert:  5038[ms] using class java.util.ArrayList
 insert: 89355[ms] using class java.util.LinkedList
prepend:  9319[ms] using class java.util.ArrayList
prepend:    17[ms] using class java.util.LinkedList
 remove:  4253[ms] using class java.util.ArrayList
 remove: 38490[ms] using class java.util.LinkedList
</pre> 
<p>
M田さんからツッコミがあったので、追記。ここで言っているのはjava.util.LinkedListの話であって、データ構造とアルゴリズムで言うところのリンクトリストとは別であることに注意。
</p>
<p>
一般論としてはリンクトリストを提供するクラスから内部で使われているノードを取得できれば(あるいはリンクトリスト自体に、現在の位置情報を持たせれば)、あるノードの直後に挿入/削除する操作はO(1)時間で実行できるが、java.util.LinkedListクラスには内部で使われているノードを取得する手段が無い。同様のことを実現するには、LinkedListからIteratorまたはListIteratorを取得する必要がある。
</p>
</p></div><div class="section">
<h3><a href="./?date=20070110#p02"><span class="sanchor">_</span></a> [<a href="./?year=2007;month=1Q;category=%B8%C0%B8%EC">言語</a>]<a href="https://web.archive.org/web/20070227041020/http://fortress.sunsource.net/">Fortress Reference Implementation</a></h3><p>
<a href="https://web.archive.org/web/20070227041020/http://machine.homeunix.org/weblog/archives/cat_script_on_java.html">さよなら、こんな毎日・・・ Script_on_Java経由</a>。FortressのReference Implementationのソースコードが公開され始めた。ソースコード本体は<a href="https://web.archive.org/web/20070227041020/http://fortress.sunsource.net/source/browse/fortress/trunk/ProjectFortress/"><strong>ここ</strong></a>からダウンロードできる模様。Fortressについては前から興味があったので、そのうち試してみたいところ。
</p>
<p>
ところで、FortressのReference Implementationでは、Parserを書くのに既存のメジャーなParser Generator(JavaCCとか)ではなく、Rats!を使っているようだ。Packrat Parsingでないと構文解析が困難な文法だったということだろうか？
</p></div>

</div>

<div class="comment">

		<div class="caption">本日のツッコミ(全2件) [<a href="./?date=20070110#c">ツッコミを入れる</a>]</div>
		<div class="commentshort">
				<p><a href="./?date=20070110#c01"><span class="canchor">_</span></a>
				<span class="commentator">M田</span>&nbsp;[Introduction to Algorithmsにはあったと思うけど、リストへの挿入、削除といったとき「n番目に..]</p>
				<p><a href="./?date=20070110#c02"><span class="canchor">_</span></a>
				<span class="commentator">みずしま</span>&nbsp;[はい。もちろん、その通りなんですけど、後者の「すでに位置情報がわかっているとき、そこへ挿入(削除)」という操作をLi..]</p>
		</div>
</div>







		<div class="referer">
		本日のリンク元 | <a href="https://web.archive.org/web/20070227041020/http://d.hatena.ne.jp/t_yano/20070128/1170006946" title="http://d.hatena.ne.jp/t_yano/20070128/1170006946">110</a> | <a href="https://web.archive.org/web/20070227041020/http://www.jitu.org/~tko/cgi-bin/bakanoemono.rb" title="http://www.jitu.org/~tko/cgi-bin/bakanoemono.rb">18</a> | <a href="https://web.archive.org/web/20070227041020/http://search.prodigy.msn.com/results.aspx?q=cexo++gey+en+tre+hombres&amp;FORM=MSNH&amp;srch_type=0" title="http://search.prodigy.msn.com/results.aspx?q=cexo ...">17</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.pt/search?q=www.corridas.com&amp;hl=pt-PT&amp;lr=lang_pt-PT&amp;sa=X&amp;oi=lrtip&amp;ct=restrict&amp;cad=7" title="http://www.google.pt/search?q=www.corridas.com&amp;hl=...">15</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.com/search?q=wwwrebelde.com.br" title="google検索(wwwrebelde.com.br)">15</a> | <a href="https://web.archive.org/web/20070227041020/http://www.atdot.net/~ko1/diary/" title="http://www.atdot.net/~ko1/diary/">14</a> | <a href="https://web.archive.org/web/20070227041020/http://search.msn.es/results.aspx?q=www.fotos+desnudas+de+11+a%C3%B1os+edad&amp;mkt=es-ES&amp;form=QBRE" title="http://search.msn.es/results.aspx?q=www.fotos desn...">14</a> | <a href="https://web.archive.org/web/20070227041020/http://galacticforum.com/" title="http://galacticforum.com">14</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.it/search?sourceid=navclient&amp;aq=t&amp;hl=it&amp;ie=UTF-8&amp;rlz=1T4GFRC_itIT203IT205&amp;q=www%2epaolini+hard%2ecom" title="http://www.google.it/search?sourceid=navclient&amp;aq=...">13</a> | <a href="https://web.archive.org/web/20070227041020/http://www.atdot.net/~ko1/diary/200702.html" title="http://www.atdot.net/~ko1/diary/200702.html">13</a> | <a href="./?date=20070110#t">TrackBack(0)</a>
		</div>
</div>


	<hr class="sep">
	
<div class="day">
<h2><span class="date"><a href="./?date=20070109">2007-01-09</a></span> <span class="title"></span></h2>

<div class="body">

<div class="section">
<h3><a href="./?date=20070109#p01"><span class="sanchor">_</span></a> [<a href="./?year=2007;month=1Q;category=Java">Java</a>]Genericなリストの簡略記法</h3><p>
<a href="https://web.archive.org/web/20070227041020/http://cappuccino.jp/keisuken/logbook/20070109.html#c">航海日誌より引用：</a>
</p>
<blockquote>
<p>
前にも言ったけど上記みたいなのができるんなら，
</p>
<pre>
ArrayList&lt;Foo&gt; foos = new ArrayList&lt;Foo&gt;();
</pre>
<p>
とかはどうにかしてほしいなぁ．
</p>
<p>
大量に同じような記述があるなら，
</p>
<pre>
List&lt;Foo&gt; newFoos() {
  return ArrayList<foo>();
}
List&lt;Foo&gt; foos = newFoos();
</pre>
<p>
とかできなくはないけど(typedefの代用)．
</p>
</blockquote>
<p>
こういうときは、多相メソッドを使って楽をするのが良いかと思います。具体的には以下のようなユーティリティクラスを定義しておいて、
</p>
<pre>
package collections;
import java.util.*;
public class CollectionUtils {
  public static &lt;T&gt; List&lt;T&gt; list() {
    return new ArrayList&lt;T&gt;();
  }
  public static &lt;T&gt; Set&lt;T&gt; set() {
    return new HashSet&lt;T&gt;();
  }
  public static &lt;K, V&gt; Map&lt;K, V&gt; map() {
    return new HashMap&lt;K, V&gt;();
  }
}
</pre>
<p>
使う方のクラスは、以下のような感じで。list(),set(),map()メソッドに与える型パラメータは、戻り値を代入する変数の型から勝手に推論してくれるので、書く必要がありません。
</p>
<pre>
import static collections.CollectionUtils.*;
public class Main {
  public static void main(String[] args) {
    List&lt;String&gt; strings = list();
    ... stringsを使ったコード ...
    Map&lt;String, String&gt; stringMap = map();
    ... stringMapを使ったコード ...
    Set&lt;String&gt; stringSet = set();
    ... stringSetを使ったコード
  }
}
</pre>
<p>
リストリテラルなどが欲しい場合は、可変長引数を組み合わせればＯＫです。
</p>
<pre>
package collections;
import java.util.*;
public class CollectionUtils {
  public static class Pair&lt;A, B&gt; {
    private A first;
    private B second;
    public Pair(A first, B second) {
      this.first = first;
      this.second = second;
    }
    public A getFirst() { return first; }
    public B getSecond() { return second; }
  }
  public static &lt;T&gt; List&lt;T&gt; list(T... elements) {
    return new ArrayList&lt;T&gt;(Arrays.asList(elements));
  }
  public static &lt;T&gt; Set&lt;T&gt; set(T... elements) {
    return new HashSet&lt;T&gt;(Arrays.asList(elements));
  }
  public static &lt;K, V&gt; Map&lt;K, V&gt; map(Pair&lt;K, V&gt;... entries) {
    Map&lt;K, V&gt; map = new HashMap&lt;K, V&gt;();
    for(Pair&lt;K, V&gt; entry : entries){
      map.put(entry.getFirst(), entry.getSecond());
    }
    return map;
  }
  public static &lt;A, B&gt; Pair&lt;A, B&gt; $(A first, B second) {
    return new Pair&lt;A, B&gt;(first, second);
  }
}
</pre>
<pre>
import static collections.CollectionUtils.*;
public class Main {
  public static void main(String[] args) {
    List&lt;String&gt; strings = list("A", "B", "C");
    ... stringsを使ったコード ...
    Map&lt;String, String&gt; stringMap = map($("X", "1"), $("Y", "2"));
    ... stringMapを使ったコード ...
    Set&lt;String&gt; stringSet = set("A", "B", "C");
    ... stringSetを使ったコード
  }
}
</pre></div>

</div>

<div class="comment">

	<div class="caption">[<a href="./?date=20070109#c">ツッコミを入れる</a>]</div>
</div>







		<div class="referer">
		本日のリンク元 | <a href="https://web.archive.org/web/20070227041020/http://search.msn.it/results.aspx?q=www.vechie+troie.it&amp;FORM=MSNH&amp;CP=65001&amp;srch_type=0&amp;mkt=it-it" title="http://search.msn.it/results.aspx?q=www.vechie tro...">27</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.com.pe/search?hl=es&amp;q=VIDEO+DESNUDAS+DE+CHIBOLITAS+DE12+13+A%C3%91OS&amp;btnG=B%C3%BAsqueda+en+Google&amp;meta=" title="http://www.google.com.pe/search?hl=es&amp;q=VIDEO DESN...">26</a> | <a href="https://web.archive.org/web/20070227041020/http://cappuccino.jp/keisuken/logbook/20070109.html" title="http://cappuccino.jp/keisuken/logbook/20070109.htm...">14</a> | <a href="https://web.archive.org/web/20070227041020/http://translate.google.com/translate?sourceid=navclient&amp;hl=it&amp;u=http%3a%2f%2fwww%2egoogle%2eit%2fsearch%3fq%3dstudentesse%2bvogliose%2bover%2b17%26hl%3dit%26lr%3d%26rls%3dGGIC%2cGGIC%3a2006%2d50%2cGGIC%3ait%26start%3d90%26sa%3dN" title="http://translate.google.com/translate?sourceid=nav...">12</a> | <a href="https://web.archive.org/web/20070227041020/http://cappuccino.jp/keisuken/logbook/" title="http://cappuccino.jp/keisuken/logbook/">12</a> | <a href="https://web.archive.org/web/20070227041020/http://reader.livedoor.com/reader/" title="http://reader.livedoor.com/reader/">11</a> | <a href="https://web.archive.org/web/20070227041020/http://search.live.com/results.aspx?mkt=es-xl&amp;FORM=TOOLBR&amp;q=http.xnxx.con" title="http://search.live.com/results.aspx?mkt=es-xl&amp;FORM...">8</a> | <a href="https://web.archive.org/web/20070227041020/http://www.google.com.br/search?q=ticas+colombianas+desnudas&amp;hl=pt-BR" title="http://www.google.com.br/search?q=ticas colombiana...">7</a> | <a href="https://web.archive.org/web/20070227041020/http://search.msn.it/previewx.aspx?q=www.raconti+di+sesso.it&amp;FORM=CBPW&amp;first=1&amp;noredir=1" title="http://search.msn.it/previewx.aspx?q=www.raconti d...">7</a> | <a href="https://web.archive.org/web/20070227041020/http://mixi.jp/view_diary.pl?url=http%3A%2F%2Fwww2.coins.tsukuba.ac.jp%2F~i021216%2Fdiary%2F%3Fdate%3D20070109%23p01&amp;owner_id=170835" title="http://mixi.jp/view_diary.pl?url=http://www2.coins...">7</a> | <a href="./?date=20070109#t">TrackBack(0)</a>
		</div>
</div>


	<hr class="sep">

<center>
Mizushima Kota/e-mail: i021216@coins.tsukuba.ac.jp/SKype ID: mizu_standard
</center>




<div class="footer">
Generated by <a href="https://web.archive.org/web/20070227041020/http://www.tdiary.org/">tDiary</a> version 2.0.0<br>
Powered by <a href="https://web.archive.org/web/20070227041020/http://www.ruby-lang.org/">Ruby</a> version 1.8.2
</div>
</body>
</html>
<!--
     FILE ARCHIVED ON 04:10:20 Feb 27, 2007 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 12:51:30 Jun 14, 2025.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  captures_list: 0.763
  exclusion.robots: 0.029
  exclusion.robots.policy: 0.018
  esindex: 0.011
  cdx.remote: 31.675
  LoadShardBlock: 153.935 (3)
  PetaboxLoader3.datanode: 118.785 (4)
  PetaboxLoader3.resolve: 137.725 (2)
  load_resource: 164.473
-->